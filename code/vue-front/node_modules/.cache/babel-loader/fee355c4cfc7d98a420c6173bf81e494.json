{"remainingRequest":"D:\\0javaproject\\code\\vue-front\\node_modules\\babel-loader\\lib\\index.js!D:\\0javaproject\\code\\vue-front\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\0javaproject\\code\\vue-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\0javaproject\\code\\vue-front\\src\\pages\\login\\login.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\0javaproject\\code\\vue-front\\src\\pages\\login\\login.vue","mtime":1742990562758},{"path":"D:\\0javaproject\\code\\vue-front\\babel.config.js","mtime":1739010664723},{"path":"D:\\0javaproject\\code\\vue-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\0javaproject\\code\\vue-front\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"D:\\0javaproject\\code\\vue-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\0javaproject\\code\\vue-front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCBtZW51IGZyb20gJ0AvY29uZmlnL21lbnUnOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGJhc2VVcmw6IHRoaXMuJGNvbmZpZy5iYXNlVXJsLAogICAgICBsb2dpblR5cGU6IDEsCiAgICAgIHJvbGVNZW51czogW10sCiAgICAgIGxvZ2luRm9ybTogewogICAgICAgIHVzZXJuYW1lOiAnJywKICAgICAgICBwYXNzd29yZDogJycsCiAgICAgICAgdGFibGVOYW1lOiAnJywKICAgICAgICBjb2RlOiAnJyAvLyDoi6XlkI7nu63pnIDopoHmj5DkuqTpqozor4HnoIHvvIzmraTlrZfmrrXlj6/kvb/nlKgKICAgICAgfSwKICAgICAgcm9sZTogJycsCiAgICAgIHJvbGVzOiBbXSwKICAgICAgcnVsZXM6IHsKICAgICAgICB1c2VybmFtZTogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogJ+ivt+i+k+WFpei0puWPtycsCiAgICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgICB9XSwKICAgICAgICBwYXNzd29yZDogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogJ+ivt+i+k+WFpeWvhueggScsCiAgICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgICB9XQogICAgICB9LAogICAgICAvLyDmlrDlop7lrZfmrrXvvJrorrDlvZXov57nu63nmbvlvZXlpLHotKXmrKHmlbDjgIHpqozor4HnoIHmlofmnKzjgIHnlKjmiLfovpPlhaXnmoTpqozor4HnoIEKICAgICAgbG9naW5FcnJvckNvdW50OiAwLAogICAgICBjYXB0Y2hhOiAnJywKICAgICAgY2FwdGNoYUlucHV0OiAnJwogICAgfTsKICB9LAogIGNyZWF0ZWQoKSB7CiAgICAvLyDop5LoibLkv6Hmga8KICAgIHRoaXMucm9sZU1lbnVzID0gbWVudS5saXN0KCk7CiAgICBmb3IgKGxldCBpdGVtIGluIHRoaXMucm9sZU1lbnVzKSB7CiAgICAgIGlmICh0aGlzLnJvbGVNZW51c1tpdGVtXS5oYXNGcm9udExvZ2luID09PSAn5pivJykgewogICAgICAgIHRoaXMucm9sZXMucHVzaCh0aGlzLnJvbGVNZW51c1tpdGVtXSk7CiAgICAgIH0KICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIHNlbGVjdENoYW5nZShlKSB7CiAgICAgIGZvciAobGV0IHggaW4gdGhpcy5yb2xlcykgewogICAgICAgIGlmICh0aGlzLnJvbGVzW3hdLnRhYmxlTmFtZSA9PT0gZSkgewogICAgICAgICAgdGhpcy5yb2xlID0gdGhpcy5yb2xlc1t4XS5yb2xlTmFtZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICAvLyDnlJ/miJDkuIDkuKo05L2N6ZqP5py66aqM6K+B56CB77yM5bm257uY5Yi25bim5bmy5omw6aG555qE5Zu+5b2i6aqM6K+B56CBCiAgICBnZW5lcmF0ZUNhcHRjaGEoKSB7CiAgICAgIGNvbnN0IGNoYXJzID0gJ0FCQ0RFRkdISktNTlBRUlNUVVZXWFlaYWJjZGVmZ2hqa21ucHFyc3R1dnd4eXoyMzQ1Njc4OSc7CiAgICAgIGxldCByZXN1bHQgPSAnJzsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA0OyBpKyspIHsKICAgICAgICByZXN1bHQgKz0gY2hhcnMuY2hhckF0KE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGNoYXJzLmxlbmd0aCkpOwogICAgICB9CiAgICAgIHRoaXMuY2FwdGNoYSA9IHJlc3VsdDsKICAgICAgdGhpcy5kcmF3Q2FwdGNoYSgpOwogICAgICB0aGlzLmNhcHRjaGFJbnB1dCA9ICcnOwogICAgfSwKICAgIC8vIOWIqeeUqENhbnZhc+e7mOWItumqjOivgeeggeWPiuW5suaJsOmhuQogICAgZHJhd0NhcHRjaGEoKSB7CiAgICAgIGNvbnN0IGNhbnZhcyA9IHRoaXMuJHJlZnMuY2FwdGNoYUNhbnZhczsKICAgICAgaWYgKCFjYW52YXMpIHJldHVybjsKICAgICAgY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7CiAgICAgIGNvbnN0IHdpZHRoID0gY2FudmFzLndpZHRoOwogICAgICBjb25zdCBoZWlnaHQgPSBjYW52YXMuaGVpZ2h0OwogICAgICAvLyDmuIXpmaTnlLvluIMKICAgICAgY3R4LmNsZWFyUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTsKICAgICAgLy8g57uY5Yi26IOM5pmvCiAgICAgIGN0eC5maWxsU3R5bGUgPSAnI2YwZjBmMCc7CiAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTsKICAgICAgLy8g57uY5Yi26aqM6K+B56CB5a2X56ymCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5jYXB0Y2hhLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgY2hhciA9IHRoaXMuY2FwdGNoYVtpXTsKICAgICAgICBjb25zdCBmb250U2l6ZSA9IDIwICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApOwogICAgICAgIGNvbnN0IGFuZ2xlID0gTWF0aC5yYW5kb20oKSAqIDMwICogTWF0aC5QSSAvIDE4MDsKICAgICAgICBjdHguZm9udCA9IGAke2ZvbnRTaXplfXB4IEFyaWFsYDsKICAgICAgICBjdHguZmlsbFN0eWxlID0gYHJnYigke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCl9LCAke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCl9LCAke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCl9KWA7CiAgICAgICAgY3R4LnNhdmUoKTsKICAgICAgICBjb25zdCB4ID0gMTAgKyBpICogMjU7CiAgICAgICAgY29uc3QgeSA9IDI1ICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApOwogICAgICAgIGN0eC50cmFuc2xhdGUoeCwgeSk7CiAgICAgICAgY3R4LnJvdGF0ZShhbmdsZSk7CiAgICAgICAgY3R4LmZpbGxUZXh0KGNoYXIsIDAsIDApOwogICAgICAgIGN0eC5yZXN0b3JlKCk7CiAgICAgIH0KICAgICAgLy8g57uY5Yi25bmy5omw57q/CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNTsgaSsrKSB7CiAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gYHJnYigke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDI1NSl9LCAke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDI1NSl9LCAke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDI1NSl9KWA7CiAgICAgICAgY3R4LmJlZ2luUGF0aCgpOwogICAgICAgIGN0eC5tb3ZlVG8oTWF0aC5yYW5kb20oKSAqIHdpZHRoLCBNYXRoLnJhbmRvbSgpICogaGVpZ2h0KTsKICAgICAgICBjdHgubGluZVRvKE1hdGgucmFuZG9tKCkgKiB3aWR0aCwgTWF0aC5yYW5kb20oKSAqIGhlaWdodCk7CiAgICAgICAgY3R4LnN0cm9rZSgpOwogICAgICB9CiAgICAgIC8vIOe7mOWItuW5suaJsOeCuQogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDMwOyBpKyspIHsKICAgICAgICBjdHguZmlsbFN0eWxlID0gYHJnYigke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDI1NSl9LCAke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDI1NSl9LCAke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDI1NSl9KWA7CiAgICAgICAgY29uc3QgeCA9IE1hdGgucmFuZG9tKCkgKiB3aWR0aDsKICAgICAgICBjb25zdCB5ID0gTWF0aC5yYW5kb20oKSAqIGhlaWdodDsKICAgICAgICBjdHguYmVnaW5QYXRoKCk7CiAgICAgICAgY3R4LmFyYyh4LCB5LCAxLCAwLCAyICogTWF0aC5QSSk7CiAgICAgICAgY3R4LmZpbGwoKTsKICAgICAgfQogICAgfSwKICAgIHN1Ym1pdEZvcm0oZm9ybU5hbWUpIHsKICAgICAgaWYgKHRoaXMucm9sZXMubGVuZ3RoICE9PSAxKSB7CiAgICAgICAgaWYgKCF0aGlzLnJvbGUpIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+ivt+mAieaLqeeZu+W9leeUqOaIt+exu+WeiycpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnJvbGUgPSB0aGlzLnJvbGVzWzBdLnJvbGVOYW1lOwogICAgICAgIHRoaXMubG9naW5Gb3JtLnRhYmxlTmFtZSA9IHRoaXMucm9sZXNbMF0udGFibGVOYW1lOwogICAgICB9CiAgICAgIC8vIOW9k+i/nue7rei+k+mUmTPmrKHlkI7moKHpqozpqozor4HnoIEKICAgICAgaWYgKHRoaXMubG9naW5FcnJvckNvdW50ID49IDMpIHsKICAgICAgICBpZiAoIXRoaXMuY2FwdGNoYUlucHV0KSB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfor7fovpPlhaXpqozor4HnoIEnKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKHRoaXMuY2FwdGNoYUlucHV0LnRvTG93ZXJDYXNlKCkgIT09IHRoaXMuY2FwdGNoYS50b0xvd2VyQ2FzZSgpKSB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfpqozor4HnoIHplJnor6/vvIzor7fph43mlrDovpPlhaUnKTsKICAgICAgICAgIHRoaXMuZ2VuZXJhdGVDYXB0Y2hhKCk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9CiAgICAgIHRoaXMuJHJlZnNbZm9ybU5hbWVdLnZhbGlkYXRlKHZhbGlkID0+IHsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgIHRoaXMuJGh0dHAuZ2V0KGAke3RoaXMubG9naW5Gb3JtLnRhYmxlTmFtZX0vbG9naW5gLCB7CiAgICAgICAgICAgIHBhcmFtczogdGhpcy5sb2dpbkZvcm0KICAgICAgICAgIH0pLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgaWYgKHJlcy5kYXRhLmNvZGUgPT09IDApIHsKICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnZnJvbnRUb2tlbicsIHJlcy5kYXRhLnRva2VuKTsKICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnVXNlclRhYmxlTmFtZScsIHRoaXMubG9naW5Gb3JtLnRhYmxlTmFtZSk7CiAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3VzZXJuYW1lJywgdGhpcy5sb2dpbkZvcm0udXNlcm5hbWUpOwogICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdmcm9udFNlc3Npb25UYWJsZScsIHRoaXMubG9naW5Gb3JtLnRhYmxlTmFtZSk7CiAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2Zyb250Um9sZScsIHRoaXMucm9sZSk7CiAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2tleVBhdGgnLCAwKTsKICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgnLycpOwogICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn55m75b2V5oiQ5YqfJyk7CiAgICAgICAgICAgICAgLy8g55m75b2V5oiQ5Yqf5ZCO6YeN572u6ZSZ6K+v6K6h5pWw5Y+K6aqM6K+B56CB5pWw5o2uCiAgICAgICAgICAgICAgdGhpcy5sb2dpbkVycm9yQ291bnQgPSAwOwogICAgICAgICAgICAgIHRoaXMuY2FwdGNoYSA9ICcnOwogICAgICAgICAgICAgIHRoaXMuY2FwdGNoYUlucHV0ID0gJyc7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMuZGF0YS5tc2cpOwogICAgICAgICAgICAgIC8vIOeZu+W9leWksei0pe+8jOe0r+iuoemUmeivr+asoeaVsO+8m+i+vuWIsDPmrKHml7bnlJ/miJDpqozor4HnoIEKICAgICAgICAgICAgICB0aGlzLmxvZ2luRXJyb3JDb3VudCsrOwogICAgICAgICAgICAgIGlmICh0aGlzLmxvZ2luRXJyb3JDb3VudCA9PT0gMykgewogICAgICAgICAgICAgICAgdGhpcy5nZW5lcmF0ZUNhcHRjaGEoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9Cn07"},{"version":3,"names":["menu","data","baseUrl","$config","loginType","roleMenus","loginForm","username","password","tableName","code","role","roles","rules","required","message","trigger","loginErrorCount","captcha","captchaInput","created","list","item","hasFrontLogin","push","methods","selectChange","e","x","roleName","generateCaptcha","chars","result","i","charAt","Math","floor","random","length","drawCaptcha","canvas","$refs","captchaCanvas","ctx","getContext","width","height","clearRect","fillStyle","fillRect","char","fontSize","angle","PI","font","save","y","translate","rotate","fillText","restore","strokeStyle","beginPath","moveTo","lineTo","stroke","arc","fill","submitForm","formName","$message","error","toLowerCase","validate","valid","$http","get","params","then","res","localStorage","setItem","token","$router","success","msg"],"sources":["src/pages/login/login.vue"],"sourcesContent":["<template>\r\n  <div class=\"login-page\">\r\n    <!-- 左侧插画区域 -->\r\n    <div class=\"login-left\">\r\n      <img\r\n          class=\"login-illustration\"\r\n          src=\"https://cdn.prod.website-files.com/6364b6fd26e298b0b8b938f5/6364b6fd26e2987e0cb93a02_reset%20password.png\"\r\n          alt=\"Illustration\"\r\n      />\r\n    </div>\r\n\r\n    <!-- 右侧表单区域 -->\r\n    <div class=\"login-right\">\r\n      <!-- 再嵌套一层容器，以便灵活调整表单位置/宽度 -->\r\n      <div class=\"form-container\">\r\n        <el-form\r\n            ref=\"loginForm\"\r\n            :model=\"loginForm\"\r\n            :rules=\"rules\"\r\n            class=\"login-form\"\r\n        >\r\n          <!-- 标题 -->\r\n          <h2 class=\"login-title\">欢迎回来，别来无恙啊!</h2>\r\n          <p class=\"login-subtitle\">基于Java的个人摄影管理网站</p>\r\n\r\n          <!-- 用户名 -->\r\n          <el-form-item prop=\"username\">\r\n            <el-input\r\n                class=\"localinput\"\r\n                v-model=\"loginForm.username\"\r\n                placeholder=\"请输入账号\"\r\n                clearable\r\n            />\r\n          </el-form-item>\r\n\r\n          <!-- 密码 -->\r\n          <el-form-item prop=\"password\">\r\n            <el-input\r\n                class=\"localinput\"\r\n                v-model=\"loginForm.password\"\r\n                type=\"password\"\r\n                placeholder=\"请输入密码\"\r\n                clearable\r\n            />\r\n          </el-form-item>\r\n\r\n          <!-- 角色选择(若需要) -->\r\n          <el-form-item v-if=\"roles.length > 1\">\r\n            <el-select\r\n                v-model=\"loginForm.tableName\"\r\n                placeholder=\"请选择角色\"\r\n                @change=\"selectChange\"\r\n                style=\"width: 100%;\"\r\n            >\r\n              <el-option\r\n                  v-for=\"(item, index) in roles\"\r\n                  :key=\"index\"\r\n                  :label=\"item.roleName\"\r\n                  :value=\"item.tableName\"\r\n              />\r\n            </el-select>\r\n          </el-form-item>\r\n\r\n          <!-- 验证码：当连续输错3次后显示 -->\r\n          <el-form-item v-if=\"loginErrorCount >= 3\">\r\n            <!-- 使用一个容器统一水平排列验证码输入框和Canvas -->\r\n            <div class=\"captcha-wrapper\">\r\n              <el-input\r\n                  class=\"authcode\"\r\n                  v-model=\"captchaInput\"\r\n                  placeholder=\"请输入验证码\"\r\n                  clearable\r\n              />\r\n              <canvas\r\n                  ref=\"captchaCanvas\"\r\n                  width=\"120\"\r\n                  height=\"40\"\r\n                  class=\"captcha-canvas\"\r\n                  @click=\"generateCaptcha\"\r\n              ></canvas>\r\n            </div>\r\n          </el-form-item>\r\n\r\n          <!-- 登录按钮 -->\r\n          <el-form-item>\r\n            <el-button\r\n                type=\"primary\"\r\n                class=\"btn-login\"\r\n                @click=\"submitForm('loginForm')\"\r\n            >\r\n              登录\r\n            </el-button>\r\n          </el-form-item>\r\n\r\n          <!-- 注册按钮(若需要) -->\r\n          <div class=\"register-links\" v-if=\"roles.length\">\r\n            <router-link\r\n                v-for=\"(item, index) in roles\"\r\n                :key=\"index\"\r\n                v-if=\"item.hasFrontRegister === '是'\"\r\n                :to=\"{ path: '/register', query: { role: item.tableName, pageFlag: 'register' } }\"\r\n                class=\"btn-register\"\r\n            >\r\n              还没有账号？点击注册{{ item.roleName.replace('注册', '') }}\r\n            </router-link>\r\n          </div>\r\n        </el-form>\r\n      </div>\r\n    </div>\r\n    <footer class=\"bottom-footer\">\r\n      @ all right reserved by  甘肃政法大学 张恒毓 2025\r\n    </footer>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport menu from '@/config/menu'\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      baseUrl: this.$config.baseUrl,\r\n      loginType: 1,\r\n      roleMenus: [],\r\n      loginForm: {\r\n        username: '',\r\n        password: '',\r\n        tableName: '',\r\n        code: '', // 若后续需要提交验证码，此字段可使用\r\n      },\r\n      role: '',\r\n      roles: [],\r\n      rules: {\r\n        username: [\r\n          { required: true, message: '请输入账号', trigger: 'blur' }\r\n        ],\r\n        password: [\r\n          { required: true, message: '请输入密码', trigger: 'blur' }\r\n        ]\r\n      },\r\n      // 新增字段：记录连续登录失败次数、验证码文本、用户输入的验证码\r\n      loginErrorCount: 0,\r\n      captcha: '',\r\n      captchaInput: ''\r\n    }\r\n  },\r\n  created() {\r\n    // 角色信息\r\n    this.roleMenus = menu.list()\r\n    for (let item in this.roleMenus) {\r\n      if (this.roleMenus[item].hasFrontLogin === '是') {\r\n        this.roles.push(this.roleMenus[item])\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    selectChange(e) {\r\n      for (let x in this.roles) {\r\n        if (this.roles[x].tableName === e) {\r\n          this.role = this.roles[x].roleName\r\n        }\r\n      }\r\n    },\r\n    // 生成一个4位随机验证码，并绘制带干扰项的图形验证码\r\n    generateCaptcha() {\r\n      const chars = 'ABCDEFGHJKMNPQRSTUVWXYZabcdefghjkmnpqrstuvwxyz23456789'\r\n      let result = ''\r\n      for (let i = 0; i < 4; i++) {\r\n        result += chars.charAt(Math.floor(Math.random() * chars.length))\r\n      }\r\n      this.captcha = result\r\n      this.drawCaptcha()\r\n      this.captchaInput = ''\r\n    },\r\n    // 利用Canvas绘制验证码及干扰项\r\n    drawCaptcha() {\r\n      const canvas = this.$refs.captchaCanvas\r\n      if (!canvas) return\r\n      const ctx = canvas.getContext('2d')\r\n      const width = canvas.width\r\n      const height = canvas.height\r\n      // 清除画布\r\n      ctx.clearRect(0, 0, width, height)\r\n      // 绘制背景\r\n      ctx.fillStyle = '#f0f0f0'\r\n      ctx.fillRect(0, 0, width, height)\r\n      // 绘制验证码字符\r\n      for (let i = 0; i < this.captcha.length; i++) {\r\n        const char = this.captcha[i]\r\n        const fontSize = 20 + Math.floor(Math.random() * 10)\r\n        const angle = Math.random() * 30 * Math.PI / 180\r\n        ctx.font = `${fontSize}px Arial`\r\n        ctx.fillStyle = `rgb(${Math.floor(Math.random()*100)}, ${Math.floor(Math.random()*100)}, ${Math.floor(Math.random()*100)})`\r\n        ctx.save()\r\n        const x = 10 + i * 25\r\n        const y = 25 + Math.floor(Math.random() * 10)\r\n        ctx.translate(x, y)\r\n        ctx.rotate(angle)\r\n        ctx.fillText(char, 0, 0)\r\n        ctx.restore()\r\n      }\r\n      // 绘制干扰线\r\n      for (let i = 0; i < 5; i++) {\r\n        ctx.strokeStyle = `rgb(${Math.floor(Math.random()*255)}, ${Math.floor(Math.random()*255)}, ${Math.floor(Math.random()*255)})`\r\n        ctx.beginPath()\r\n        ctx.moveTo(Math.random() * width, Math.random() * height)\r\n        ctx.lineTo(Math.random() * width, Math.random() * height)\r\n        ctx.stroke()\r\n      }\r\n      // 绘制干扰点\r\n      for (let i = 0; i < 30; i++) {\r\n        ctx.fillStyle = `rgb(${Math.floor(Math.random()*255)}, ${Math.floor(Math.random()*255)}, ${Math.floor(Math.random()*255)})`\r\n        const x = Math.random() * width\r\n        const y = Math.random() * height\r\n        ctx.beginPath()\r\n        ctx.arc(x, y, 1, 0, 2 * Math.PI)\r\n        ctx.fill()\r\n      }\r\n    },\r\n    submitForm(formName) {\r\n      if (this.roles.length !== 1) {\r\n        if (!this.role) {\r\n          this.$message.error('请选择登录用户类型')\r\n          return\r\n        }\r\n      } else {\r\n        this.role = this.roles[0].roleName\r\n        this.loginForm.tableName = this.roles[0].tableName\r\n      }\r\n      // 当连续输错3次后校验验证码\r\n      if (this.loginErrorCount >= 3) {\r\n        if (!this.captchaInput) {\r\n          this.$message.error('请输入验证码')\r\n          return\r\n        }\r\n        if (this.captchaInput.toLowerCase() !== this.captcha.toLowerCase()) {\r\n          this.$message.error('验证码错误，请重新输入')\r\n          this.generateCaptcha()\r\n          return\r\n        }\r\n      }\r\n      this.$refs[formName].validate((valid) => {\r\n        if (valid) {\r\n          this.$http\r\n              .get(`${this.loginForm.tableName}/login`, { params: this.loginForm })\r\n              .then((res) => {\r\n                if (res.data.code === 0) {\r\n                  localStorage.setItem('frontToken', res.data.token)\r\n                  localStorage.setItem('UserTableName', this.loginForm.tableName)\r\n                  localStorage.setItem('username', this.loginForm.username)\r\n                  localStorage.setItem('frontSessionTable', this.loginForm.tableName)\r\n                  localStorage.setItem('frontRole', this.role)\r\n                  localStorage.setItem('keyPath', 0)\r\n                  this.$router.push('/')\r\n                  this.$message.success('登录成功')\r\n                  // 登录成功后重置错误计数及验证码数据\r\n                  this.loginErrorCount = 0\r\n                  this.captcha = ''\r\n                  this.captchaInput = ''\r\n                } else {\r\n                  this.$message.error(res.data.msg)\r\n                  // 登录失败，累计错误次数；达到3次时生成验证码\r\n                  this.loginErrorCount++\r\n                  if (this.loginErrorCount === 3) {\r\n                    this.generateCaptcha()\r\n                  }\r\n                }\r\n              })\r\n        } else {\r\n          return false\r\n        }\r\n      })\r\n    }\r\n  },\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.login-page {\r\n  display: flex;\r\n  min-height: 100vh;\r\n\r\n  /* 左侧插画区域 (占比6) */\r\n  .login-left {\r\n    flex: 6;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background-color: #f8f9fa;\r\n  }\r\n\r\n  .login-illustration {\r\n    max-width: 40%;\r\n    height: auto;\r\n  }\r\n\r\n  /* 右侧表单区域 (占比4) */\r\n  .login-right {\r\n    flex: 4;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background-color: #fff;\r\n  }\r\n\r\n  .form-container {\r\n    width: 80%;\r\n    max-width: 560px;\r\n    margin: 0 auto;\r\n  }\r\n\r\n  .login-subtitle {\r\n    margin-bottom: 150px;\r\n    font-size: 18px;\r\n    text-align: center;\r\n    color: #747474;\r\n  }\r\n  .login-form {\r\n    .login-title {\r\n      margin-top: 50px;\r\n      margin-bottom: 30px;\r\n      font-size: 40px;\r\n      font-weight: 600;\r\n      color: #333;\r\n      text-align: center;\r\n    }\r\n    // 错误标签外边框左移\r\n    .el-form-item__error{\r\n      margin-left: 120px;\r\n\r\n    .el-form-item {\r\n      margin-bottom: 30px;\r\n      .el-input__inner {\r\n        height: 44px;\r\n      }\r\n\r\n    }\r\n\r\n\r\n    }\r\n\r\n    .localinput, .authcode{\r\n      width: 300px;\r\n      border-radius: 30px;\r\n      margin-left: 120px;\r\n\r\n    }\r\n    .authcode{\r\n      width: 175px;\r\n    }\r\n    .btn-login {\r\n      width: 100px;\r\n      height: 44px;\r\n      font-size: 16px;\r\n      margin: 30px 230px;\r\n      border-radius: 30px;\r\n    }\r\n\r\n    .register-links {\r\n      margin-top: 20px;\r\n      display: flex;\r\n      flex-direction: column;\r\n\r\n      .btn-register {\r\n        margin-top: 8px;\r\n        text-align: center;\r\n        color: #909399;\r\n        text-decoration: none;\r\n\r\n        &:hover {\r\n          text-decoration: none;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.bottom-footer {\r\n  position: absolute;\r\n  bottom: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 80px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  text-align: center;\r\n  background-color: white;\r\n  font-size: 16px;\r\n  color: #909399;\r\n  border-top: 1px solid #ddd;\r\n}\r\n\r\n///* 新增：验证码容器统一水平排列 */\r\n// 用于包裹验证码输入框和 Canvas，这样可以通过 CSS 使它们在同一行排列。\r\n.captcha-wrapper {\r\n  display: flex;\r\n  align-items: center;\r\n\r\n}\r\n\r\n.captcha-canvas {\r\n  //margin-left: 10px;\r\n  width: 125px;\r\n  height: 40px;\r\n  cursor: pointer;\r\n  border: 1px solid #ddd;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]}]}