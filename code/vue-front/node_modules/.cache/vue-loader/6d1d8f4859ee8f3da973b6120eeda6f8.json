{"remainingRequest":"D:\\0javaproject\\code\\vue-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\0javaproject\\code\\vue-front\\src\\pages\\register\\register.vue?vue&type=style&index=0&id=2d48598a&scoped=true&lang=scss","dependencies":[{"path":"D:\\0javaproject\\code\\vue-front\\src\\pages\\register\\register.vue","mtime":1742998977392},{"path":"D:\\0javaproject\\code\\vue-front\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\0javaproject\\code\\vue-front\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\0javaproject\\code\\vue-front\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\0javaproject\\code\\vue-front\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\0javaproject\\code\\vue-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\0javaproject\\code\\vue-front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQouY29udGFpbmVyIHsNCiAgZGlzcGxheTogZmxleDsNCiAgZmxleC1kaXJlY3Rpb246IHJvdzsNCiAgbWluLWhlaWdodDogMTAwdmg7DQogIGJhY2tncm91bmQtY29sb3I6ICNmNWY3ZmE7DQp9DQoNCi8qIOW3puS+p+aPkueUu+WMuuWfnyAqLw0KLmxlZnQtaWxsdXN0cmF0aW9uIHsNCiAgZmxleDogMTsNCiAgZGlzcGxheTogZmxleDsNCiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQp9DQoNCi5pbGx1c3RyYXRpb24taW1nIHsNCiAgd2lkdGg6IDUwJTsNCiAgbWF4LXdpZHRoOiA4MDBweDsNCn0NCg0KLyog5Y+z5L6n6KGo5Y2V5Yy65Z+fICovDQoucmlnaHQtZm9ybSB7DQogIGZsZXg6IDE7DQogIGRpc3BsYXk6IGZsZXg7DQogIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICBhbGlnbi1pdGVtczogY2VudGVyOw0KfQ0KDQovKiDooajljZXmlbTkvZPmoLflvI8gKi8NCi5yZ3MtZm9ybSB7DQogIGJhY2tncm91bmQ6ICNmZmY7DQogIGJvcmRlci1yYWRpdXM6IDMwcHg7DQogIGJveC1zaGFkb3c6IDAgMCAyMHB4IHJnYmEoMCwgMCwgMCwgMC4xKTsNCiAgd2lkdGg6IDcwMHB4Ow0KICBwYWRkaW5nOiAzMHB4IDMwcHg7DQogIGRpc3BsYXk6IGZsZXg7DQogIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQp9DQoNCi8qIOihqOWNleWktOmDqCAqLw0KLmZvcm0taGVhZGVyIHsNCiAgbWFyZ2luOiA0MHB4Ow0KICBmb250LXNpemU6IDM1cHg7DQogIGNvbG9yOiAjMzMzOw0KICB0ZXh0LWFsaWduOiBjZW50ZXI7DQp9DQoNCi8qIOihqOWNlemhuSAqLw0KLmZvcm0taXRlbSB7DQogIHdpZHRoOiA1NDBweDsNCiAgbWFyZ2luLWJvdHRvbTogMTVweDsNCiAgZGlzcGxheTogZmxleDsNCiAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCn0NCg0KLmZvcm0tbGFiZWwgew0KICB3aWR0aDogOTBweDsNCiAgY29sb3I6ICM2NjY7DQogIGZvbnQtc2l6ZTogMTRweDsNCiAgdGV4dC1hbGlnbjogcmlnaHQ7DQogIG1hcmdpbi1yaWdodDogMTBweDsNCn0NCg0KLnJlcXVpcmVkIHsNCiAgY29sb3I6IHJlZDsNCn0NCg0KLmZvcm0taW5wdXQgew0KICB3aWR0aDogNTQwcHg7DQogIGhlaWdodDogNTBweDsNCn0NCg0KLyog6aqM6K+B56CB5qC35byPICovDQouY2FwdGNoYS13cmFwcGVyIHsNCiAgZGlzcGxheTogZmxleDsNCiAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCn0NCi5jYXB0Y2hhLWlucHV0IHsNCiAgd2lkdGg6IDQyNXB4Ow0KfQ0KLmNhcHRjaGEtY2FudmFzIHsNCiAgLy9tYXJnaW4tbGVmdDogMTBweDsNCiAgY3Vyc29yOiBwb2ludGVyOw0KICBib3JkZXI6IDFweCBzb2xpZCAjZGRkOw0KICBoZWlnaHQ6IDQwcHg7DQogIG1hcmdpbi1ib3R0b206IDEwcHg7DQp9DQoNCi8qIOaPkOS6pOaMiemSriAqLw0KLnN1Ym1pdC1idXR0b24gew0KICB3aWR0aDogMTAwcHg7DQogIGhlaWdodDogNDRweDsNCiAgbWFyZ2luOiAyMHB4IDA7DQogIGZvbnQtc2l6ZTogMTZweDsNCiAgYmFja2dyb3VuZDogIzQwOWVmZjsNCiAgY29sb3I6ICNmZmY7DQogIGJvcmRlcjogbm9uZTsNCiAgYm9yZGVyLXJhZGl1czogMzBweDsNCiAgY3Vyc29yOiBwb2ludGVyOw0KICAmOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiAjNjZiMWZmOw0KICB9DQp9DQoNCi8qIOmTvuaOpeagt+W8jyAqLw0KLmxvZ2luLWxpbmsgew0KICBjb2xvcjogIzkwOTM5OTsNCiAgZm9udC1zaXplOiAxNHB4Ow0KICB0ZXh0LWRlY29yYXRpb246IG5vbmU7DQogIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgZGlzcGxheTogYmxvY2s7DQogIG1hcmdpbi10b3A6IDVweDsNCn0NCg0KLyog6ISa5rOoICovDQouYm90dG9tLWZvb3RlciB7DQogIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgYm90dG9tOiAwOw0KICBsZWZ0OiAwOw0KICB3aWR0aDogMTAwJTsNCiAgaGVpZ2h0OiA4MHB4Ow0KICBkaXNwbGF5OiBmbGV4Ow0KICBhbGlnbi1pdGVtczogY2VudGVyOw0KICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgdGV4dC1hbGlnbjogY2VudGVyOw0KICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTsNCiAgZm9udC1zaXplOiAxNnB4Ow0KICBjb2xvcjogIzkwOTM5OTsNCiAgYm9yZGVyLXRvcDogMXB4IHNvbGlkICNkZGQ7DQp9DQo="},{"version":3,"sources":["register.vue"],"names":[],"mappings":";AAqQA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"register.vue","sourceRoot":"src/pages/register","sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <!-- 左侧插画区域 -->\r\n    <div class=\"left-illustration\">\r\n      <img\r\n          src=\"https://cdn.prod.website-files.com/6364b6fd26e298b0b8b938f5/6364b6fd26e298040bb939fc_signin.png\"\r\n          alt=\"Illustration\"\r\n          class=\"illustration-img\"\r\n      />\r\n    </div>\r\n\r\n    <!-- 右侧表单区域 -->\r\n    <div class=\"right-form\">\r\n      <el-form\r\n          class=\"rgs-form\"\r\n          v-if=\"pageFlag=='register'\"\r\n          ref=\"registerForm\"\r\n          :model=\"registerForm\"\r\n          :rules=\"rules\"\r\n      >\r\n        <div class=\"form-header\">欢迎加入大家庭</div>\r\n\r\n        <!-- 账号：必填项 -->\r\n        <el-form-item class=\"form-item\" v-if=\"tableName=='ordinaryUser'\" prop=\"account\">\r\n          <label class=\"form-label\"><span class=\"required\">*</span>账号名称：</label>\r\n          <el-input\r\n              v-model=\"registerForm.account\"\r\n              placeholder=\"请输入账号\"\r\n              class=\"form-input\"\r\n          />\r\n        </el-form-item>\r\n\r\n        <!-- 密码：必填项 -->\r\n        <el-form-item class=\"form-item\" v-if=\"tableName=='ordinaryUser'\" prop=\"password\">\r\n          <label class=\"form-label\"><span class=\"required\">*</span>密码：</label>\r\n          <el-input\r\n              v-model=\"registerForm.password\"\r\n              type=\"password\"\r\n              placeholder=\"请输入密码\"\r\n              class=\"form-input\"\r\n          />\r\n        </el-form-item>\r\n\r\n        <!-- 确认密码：必填项 -->\r\n        <el-form-item class=\"form-item\" v-if=\"tableName=='ordinaryUser'\" prop=\"password2\">\r\n          <label class=\"form-label\"><span class=\"required\">*</span>确认密码：</label>\r\n          <el-input\r\n              v-model=\"registerForm.password2\"\r\n              type=\"password\"\r\n              placeholder=\"请再次输入密码\"\r\n              class=\"form-input\"\r\n          />\r\n        </el-form-item>\r\n\r\n        <!-- 验证码：始终显示 -->\r\n        <el-form-item class=\"form-item\" prop=\"code\">\r\n          <label class=\"form-label\"><span class=\"required\">*</span>验证码：</label>\r\n          <div class=\"captcha-wrapper\">\r\n            <el-input\r\n                v-model=\"registerForm.code\"\r\n                placeholder=\"请输入验证码\"\r\n                class=\"form-input captcha-input\"\r\n            />\r\n            <canvas\r\n                ref=\"captchaCanvas\"\r\n                width=\"120\"\r\n                height=\"40\"\r\n                class=\"captcha-canvas\"\r\n                @click=\"generateCaptcha\"\r\n            ></canvas>\r\n          </div>\r\n        </el-form-item>\r\n\r\n        <el-button class=\"submit-button\" type=\"primary\" @click=\"submitForm('registerForm')\">\r\n          注册\r\n        </el-button>\r\n        <router-link class=\"login-link\" to=\"/login\">已有账户登录</router-link>\r\n      </el-form>\r\n    </div>\r\n    <footer class=\"bottom-footer\">\r\n      @ all right reserved by  甘肃政法大学 张恒毓 2025\r\n    </footer>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      pageFlag: '',\r\n      tableName: '',\r\n      registerForm: {},\r\n      rules: {},\r\n      // 新增：用于验证码校验\r\n      captcha: '', // 记录当前生成的验证码\r\n      ordinaryUseruserSexOptions: [],\r\n    };\r\n  },\r\n  mounted() {\r\n    if (this.$route.query.pageFlag === 'register') {\r\n      this.tableName = this.$route.query.role;\r\n      if (this.tableName === 'ordinaryUser') {\r\n        this.registerForm = {\r\n          account: '',\r\n          password: '',\r\n          password2: '',\r\n          code: '', // 用于验证码输入\r\n          realName: '',\r\n          userSex: '',\r\n          mobile: '',\r\n          email: '',\r\n          idCard: '',\r\n          userAvatar: '',\r\n          money: '',\r\n          vip: '',\r\n        };\r\n        // 设置必填规则\r\n        this.rules.account = [{ required: true, message: '请输入账号', trigger: ['blur', 'change'] }];\r\n        this.rules.password = [\r\n          { required: true, message: '请输入密码', trigger: ['blur', 'change'] },\r\n          { validator: this.validatePassword, trigger: ['blur', 'change'] }\r\n        ];\r\n        this.rules.password2 = [\r\n          { required: true, message: '请再次输入密码', trigger: ['blur', 'change'] },\r\n          { validator: this.validatePassword2, trigger: ['blur', 'change'] }\r\n        ];\r\n        this.rules.code = [{ required: true, message: '请输入验证码', trigger: ['blur', 'change'] }];\r\n        // 其他可选规则\r\n        this.rules.mobile = [{ required: false, validator: this.$validate?.isMobile, trigger: 'blur' }];\r\n        this.rules.money = [{ required: false, validator: this.$validate?.isNumber, trigger: 'blur' }];\r\n      }\r\n      // 注册时始终生成验证码\r\n      this.generateCaptcha();\r\n    }\r\n  },\r\n  created() {\r\n    this.pageFlag = this.$route.query.pageFlag;\r\n    if (this.$route.query.pageFlag === 'register') {\r\n      if (this.tableName === 'ordinaryUser') {\r\n        // 备用：若需要在 created 中设置规则，可在此进行配置\r\n      }\r\n      this.ordinaryUseruserSexOptions = '男,女'.split(',');\r\n    }\r\n  },\r\n  methods: {\r\n    validatePassword(rule, value, callback) {\r\n      // 密码复杂度要求：至少6位，必须包含大写字母、小写字母、数字和特殊符号\r\n      const pattern = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[\\W_]).{6,}$/;\r\n      if (!value) {\r\n        this.$message.error('请输入密码');\r\n        return callback(new Error('请输入密码'));\r\n      }\r\n      if (!pattern.test(value)) {\r\n        this.$message.error('密码至少6位，需包含大写字母、小写字母、数字和特殊符号');\r\n        return callback(new Error('密码复杂度不符合要求'));\r\n      }\r\n      callback();\r\n    },\r\n    validatePassword2(rule, value, callback) {\r\n      if (!value) {\r\n        this.$message.error('请再次输入密码');\r\n        return callback(new Error('请再次输入密码'));\r\n      }\r\n      if (value !== this.registerForm.password) {\r\n        this.$message.error('两次密码输入不一致');\r\n        return callback(new Error('两次密码输入不一致'));\r\n      }\r\n      callback();\r\n    },\r\n    // 生成4位随机验证码，并调用绘制函数\r\n    generateCaptcha() {\r\n      const chars = 'ABCDEFGHJKMNPQRSTUVWXYZabcdefghjkmnpqrstuvwxyz23456789';\r\n      let result = '';\r\n      for (let i = 0; i < 4; i++) {\r\n        result += chars.charAt(Math.floor(Math.random() * chars.length));\r\n      }\r\n      this.captcha = result;\r\n      this.drawCaptcha();\r\n      // 清空用户输入的验证码\r\n      this.registerForm.code = '';\r\n    },\r\n    // 使用Canvas绘制验证码和干扰项\r\n    drawCaptcha() {\r\n      const canvas = this.$refs.captchaCanvas;\r\n      if (!canvas) return;\r\n      const ctx = canvas.getContext('2d');\r\n      const width = canvas.width;\r\n      const height = canvas.height;\r\n      ctx.clearRect(0, 0, width, height);\r\n      // 绘制背景\r\n      ctx.fillStyle = '#f0f0f0';\r\n      ctx.fillRect(0, 0, width, height);\r\n      // 绘制验证码字符\r\n      for (let i = 0; i < this.captcha.length; i++) {\r\n        const char = this.captcha[i];\r\n        const fontSize = 20 + Math.floor(Math.random() * 10);\r\n        const angle = Math.random() * 30 * Math.PI / 180;\r\n        ctx.font = `${fontSize}px Arial`;\r\n        ctx.fillStyle = `rgb(${Math.floor(Math.random()*100)}, ${Math.floor(Math.random()*100)}, ${Math.floor(Math.random()*100)})`;\r\n        ctx.save();\r\n        const x = 10 + i * 25;\r\n        const y = 25 + Math.floor(Math.random() * 10);\r\n        ctx.translate(x, y);\r\n        ctx.rotate(angle);\r\n        ctx.fillText(char, 0, 0);\r\n        ctx.restore();\r\n      }\r\n      // 绘制干扰线\r\n      for (let i = 0; i < 5; i++) {\r\n        ctx.strokeStyle = `rgb(${Math.floor(Math.random()*255)}, ${Math.floor(Math.random()*255)}, ${Math.floor(Math.random()*255)})`;\r\n        ctx.beginPath();\r\n        ctx.moveTo(Math.random() * width, Math.random() * height);\r\n        ctx.lineTo(Math.random() * width, Math.random() * height);\r\n        ctx.stroke();\r\n      }\r\n      // 绘制干扰点\r\n      for (let i = 0; i < 30; i++) {\r\n        ctx.fillStyle = `rgb(${Math.floor(Math.random()*255)}, ${Math.floor(Math.random()*255)}, ${Math.floor(Math.random()*255)})`;\r\n        const x = Math.random() * width;\r\n        const y = Math.random() * height;\r\n        ctx.beginPath();\r\n        ctx.arc(x, y, 1, 0, 2 * Math.PI);\r\n        ctx.fill();\r\n      }\r\n    },\r\n    submitForm(formName) {\r\n      // 先对密码字段进行单独验证\r\n      this.$refs[formName].validateField('password', (error) => {\r\n        if (error) {\r\n          return;\r\n        }\r\n        // 再执行整体表单校验\r\n        this.$refs[formName].validate((valid) => {\r\n          if (valid) {\r\n            const url = this.tableName + '/register';\r\n            // 额外校验（例如账号不能为空等），这里已由规则处理\r\n            this.$http.post(url, this.registerForm).then((res) => {\r\n              if (res.data.code === 0) {\r\n                this.$message({\r\n                  message: '注册成功',\r\n                  type: 'success',\r\n                  duration: 1500,\r\n                  onClose: () => {\r\n                    this.$router.push('/login');\r\n                  },\r\n                });\r\n              } else {\r\n                this.$message.error(res.data.msg);\r\n              }\r\n            });\r\n          } else {\r\n            return false;\r\n          }\r\n        });\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.container {\r\n  display: flex;\r\n  flex-direction: row;\r\n  min-height: 100vh;\r\n  background-color: #f5f7fa;\r\n}\r\n\r\n/* 左侧插画区域 */\r\n.left-illustration {\r\n  flex: 1;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n\r\n.illustration-img {\r\n  width: 50%;\r\n  max-width: 800px;\r\n}\r\n\r\n/* 右侧表单区域 */\r\n.right-form {\r\n  flex: 1;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n\r\n/* 表单整体样式 */\r\n.rgs-form {\r\n  background: #fff;\r\n  border-radius: 30px;\r\n  box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);\r\n  width: 700px;\r\n  padding: 30px 30px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n}\r\n\r\n/* 表单头部 */\r\n.form-header {\r\n  margin: 40px;\r\n  font-size: 35px;\r\n  color: #333;\r\n  text-align: center;\r\n}\r\n\r\n/* 表单项 */\r\n.form-item {\r\n  width: 540px;\r\n  margin-bottom: 15px;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.form-label {\r\n  width: 90px;\r\n  color: #666;\r\n  font-size: 14px;\r\n  text-align: right;\r\n  margin-right: 10px;\r\n}\r\n\r\n.required {\r\n  color: red;\r\n}\r\n\r\n.form-input {\r\n  width: 540px;\r\n  height: 50px;\r\n}\r\n\r\n/* 验证码样式 */\r\n.captcha-wrapper {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n.captcha-input {\r\n  width: 425px;\r\n}\r\n.captcha-canvas {\r\n  //margin-left: 10px;\r\n  cursor: pointer;\r\n  border: 1px solid #ddd;\r\n  height: 40px;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n/* 提交按钮 */\r\n.submit-button {\r\n  width: 100px;\r\n  height: 44px;\r\n  margin: 20px 0;\r\n  font-size: 16px;\r\n  background: #409eff;\r\n  color: #fff;\r\n  border: none;\r\n  border-radius: 30px;\r\n  cursor: pointer;\r\n  &:hover {\r\n    background: #66b1ff;\r\n  }\r\n}\r\n\r\n/* 链接样式 */\r\n.login-link {\r\n  color: #909399;\r\n  font-size: 14px;\r\n  text-decoration: none;\r\n  text-align: center;\r\n  display: block;\r\n  margin-top: 5px;\r\n}\r\n\r\n/* 脚注 */\r\n.bottom-footer {\r\n  position: absolute;\r\n  bottom: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 80px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  text-align: center;\r\n  background-color: white;\r\n  font-size: 16px;\r\n  color: #909399;\r\n  border-top: 1px solid #ddd;\r\n}\r\n</style>\r\n"]}]}