{"remainingRequest":"D:\\0javaproject\\code\\vue-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\0javaproject\\code\\vue-admin\\src\\views\\login.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\0javaproject\\code\\vue-admin\\src\\views\\login.vue","mtime":1742912559294},{"path":"D:\\0javaproject\\code\\vue-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\0javaproject\\code\\vue-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"D:\\0javaproject\\code\\vue-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\0javaproject\\code\\vue-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgbWVudSBmcm9tICJAL3V0aWxzL21lbnUiOw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIHZlcmlmeUNoZWNrMjogZmFsc2UsDQogICAgICBmbGFnOiBmYWxzZSwNCiAgICAgIGJhc2VVcmw6IHRoaXMuJGJhc2UudXJsLA0KICAgICAgbG9naW5UeXBlOiAxLA0KICAgICAgcnVsZXNGb3JtOiB7DQogICAgICAgIHVzZXJuYW1lOiAiIiwNCiAgICAgICAgcGFzc3dvcmQ6ICIiLA0KICAgICAgICByb2xlOiAiIiwNCiAgICAgIH0sDQogICAgICBtZW51czogW10sDQogICAgICByb2xlczogW10sDQogICAgICB0YWJsZU5hbWU6ICIiLA0KICAgICAgLy8g5paw5aKe5a2X5q61DQogICAgICBsb2dpbkVycm9yQ291bnQ6IDAsIC8vIOiusOW9lei/nue7reeZu+W9leWksei0peasoeaVsA0KICAgICAgY2FwdGNoYTogIiIsICAgICAgICAvLyDpqozor4HnoIHlrZfnrKbkuLINCiAgICAgIGNhcHRjaGFJbnB1dDogIiIsICAgLy8g55So5oi36L6T5YWl55qE6aqM6K+B56CBDQogICAgfTsNCiAgfSwNCiAgbW91bnRlZCgpIHsNCiAgICBsZXQgbWVudXMgPSBtZW51Lmxpc3QoKTsNCiAgICB0aGlzLm1lbnVzID0gbWVudXM7DQogICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm1lbnVzLmxlbmd0aDsgaSsrKSB7DQogICAgICBpZiAodGhpcy5tZW51c1tpXS5oYXNCYWNrTG9naW4gPT0gJ+aYrycpIHsNCiAgICAgICAgdGhpcy5yb2xlcy5wdXNoKHRoaXMubWVudXNbaV0pOw0KICAgICAgfQ0KICAgIH0NCiAgfSwNCiAgbWV0aG9kczogew0KICAgIC8vIOeUn+aIkOmqjOivgeeggeWPiue7mOWItuW5suaJsOmhuQ0KICAgIGdlbmVyYXRlQ2FwdGNoYSgpIHsNCiAgICAgIC8vIOeUn+aIkOS4gOS4qumaj+acujTkvY3pqozor4HnoIHlrZfnrKbkuLINCiAgICAgIGNvbnN0IGNoYXJzID0gJ0FCQ0RFRkdISktNTlBRUlNUVVZXWFlaYWJjZGVmZ2hqa21ucHFyc3R1dnd4eXoyMzQ1Njc4OSc7DQogICAgICBsZXQgcmVzdWx0ID0gJyc7DQogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDQ7IGkrKykgew0KICAgICAgICByZXN1bHQgKz0gY2hhcnMuY2hhckF0KE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGNoYXJzLmxlbmd0aCkpOw0KICAgICAgfQ0KICAgICAgdGhpcy5jYXB0Y2hhID0gcmVzdWx0Ow0KICAgICAgLy8g6LCD55So57uY5Yi25pa55rOVDQogICAgICB0aGlzLmRyYXdDYXB0Y2hhKCk7DQogICAgICAvLyDmr4/mrKHliLfmlrDml7bmuIXnqbrnlKjmiLfovpPlhaUNCiAgICAgIHRoaXMuY2FwdGNoYUlucHV0ID0gIiI7DQogICAgfSwNCiAgICAvLyDnu5jliLbpqozor4HnoIHliLBjYW52YXPkuIoNCiAgICBkcmF3Q2FwdGNoYSgpIHsNCiAgICAgIGNvbnN0IGNhbnZhcyA9IHRoaXMuJHJlZnMuY2FwdGNoYUNhbnZhczsNCiAgICAgIGlmICghY2FudmFzKSByZXR1cm47DQogICAgICBjb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgiMmQiKTsNCiAgICAgIGNvbnN0IHdpZHRoID0gY2FudmFzLndpZHRoOw0KICAgICAgY29uc3QgaGVpZ2h0ID0gY2FudmFzLmhlaWdodDsNCiAgICAgIC8vIOa4heepuueUu+W4gw0KICAgICAgY3R4LmNsZWFyUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTsNCiAgICAgIC8vIOe7mOWItuiDjOaZr+minOiJsg0KICAgICAgY3R4LmZpbGxTdHlsZSA9ICIjZjBmMGYwIjsNCiAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTsNCiAgICAgIC8vIOe7mOWItumqjOivgeeggeaWh+Wtlw0KICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmNhcHRjaGEubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgY29uc3QgY2hhciA9IHRoaXMuY2FwdGNoYVtpXTsNCiAgICAgICAgLy8g6ZqP5py65a2X5L2T5aSn5bCP5ZKM6aKc6ImyDQogICAgICAgIGNvbnN0IGZvbnRTaXplID0gMjAgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7DQogICAgICAgIGNvbnN0IGFuZ2xlID0gTWF0aC5yYW5kb20oKSAqIDMwICogTWF0aC5QSSAvIDE4MDsNCiAgICAgICAgY3R4LmZvbnQgPSBgJHtmb250U2l6ZX1weCBBcmlhbGA7DQogICAgICAgIGN0eC5maWxsU3R5bGUgPSBgcmdiKCR7TWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjEwMCl9LCAke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSoxMDApfSwgJHtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqMTAwKX0pYDsNCiAgICAgICAgLy8g6K6+572u5paH5a2X5L2N572u5Y+K5peL6L2sDQogICAgICAgIGN0eC5zYXZlKCk7DQogICAgICAgIGNvbnN0IHggPSAxMCArIGkgKiAyNTsNCiAgICAgICAgY29uc3QgeSA9IDI1ICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApOw0KICAgICAgICBjdHgudHJhbnNsYXRlKHgsIHkpOw0KICAgICAgICBjdHgucm90YXRlKGFuZ2xlKTsNCiAgICAgICAgY3R4LmZpbGxUZXh0KGNoYXIsIDAsIDApOw0KICAgICAgICBjdHgucmVzdG9yZSgpOw0KICAgICAgfQ0KICAgICAgLy8g57uY5Yi25bmy5omw57q/DQogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDU7IGkrKykgew0KICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSBgcmdiKCR7TWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjI1NSl9LCAke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSoyNTUpfSwgJHtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqMjU1KX0pYDsNCiAgICAgICAgY3R4LmJlZ2luUGF0aCgpOw0KICAgICAgICBjdHgubW92ZVRvKE1hdGgucmFuZG9tKCkgKiB3aWR0aCwgTWF0aC5yYW5kb20oKSAqIGhlaWdodCk7DQogICAgICAgIGN0eC5saW5lVG8oTWF0aC5yYW5kb20oKSAqIHdpZHRoLCBNYXRoLnJhbmRvbSgpICogaGVpZ2h0KTsNCiAgICAgICAgY3R4LnN0cm9rZSgpOw0KICAgICAgfQ0KICAgICAgLy8g57uY5Yi25bmy5omw54K5DQogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDMwOyBpKyspIHsNCiAgICAgICAgY3R4LmZpbGxTdHlsZSA9IGByZ2IoJHtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqMjU1KX0sICR7TWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjI1NSl9LCAke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSoyNTUpfSlgOw0KICAgICAgICBjb25zdCB4ID0gTWF0aC5yYW5kb20oKSAqIHdpZHRoOw0KICAgICAgICBjb25zdCB5ID0gTWF0aC5yYW5kb20oKSAqIGhlaWdodDsNCiAgICAgICAgY3R4LmJlZ2luUGF0aCgpOw0KICAgICAgICBjdHguYXJjKHgsIHksIDEsIDAsIDIgKiBNYXRoLlBJKTsNCiAgICAgICAgY3R4LmZpbGwoKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIC8vIOazqOWGjA0KICAgIHJlZ2lzdGVyKHRhYmxlTmFtZSkgew0KICAgICAgdGhpcy4kc3RvcmFnZS5zZXQoImxvZ2luVGFibGUiLCB0YWJsZU5hbWUpOw0KICAgICAgdGhpcy4kcm91dGVyLnB1c2goeyBwYXRoOiAiL3JlZ2lzdGVyIiwgcXVlcnk6IHsgcGFnZUZsYWc6ICJyZWdpc3RlciIgfSB9KTsNCiAgICB9LA0KICAgIC8vIOeZu+mZhg0KICAgIGxvZ2luKCkgew0KICAgICAgLy8g5b2T6L+e57ut5aSx6LSlM+asoeWQju+8jOmcgOimgemqjOivgemqjOivgeeggQ0KICAgICAgaWYgKHRoaXMubG9naW5FcnJvckNvdW50ID49IDMpIHsNCiAgICAgICAgaWYgKCF0aGlzLmNhcHRjaGFJbnB1dCkgew0KICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIuivt+i+k+WFpemqjOivgeeggSIpOw0KICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgICBpZiAodGhpcy5jYXB0Y2hhSW5wdXQudG9Mb3dlckNhc2UoKSAhPT0gdGhpcy5jYXB0Y2hhLnRvTG93ZXJDYXNlKCkpIHsNCiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLpqozor4HnoIHplJnor6/vvIzor7fph43mlrDovpPlhaUiKTsNCiAgICAgICAgICB0aGlzLmdlbmVyYXRlQ2FwdGNoYSgpOw0KICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgaWYgKCF0aGlzLnJ1bGVzRm9ybS51c2VybmFtZSkgew0KICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLor7fovpPlhaXnlKjmiLflkI0iKTsNCiAgICAgICAgcmV0dXJuOw0KICAgICAgfQ0KICAgICAgaWYgKCF0aGlzLnJ1bGVzRm9ybS5wYXNzd29yZCkgew0KICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLor7fovpPlhaXlr4bnoIEiKTsNCiAgICAgICAgcmV0dXJuOw0KICAgICAgfQ0KICAgICAgaWYgKHRoaXMucm9sZXMubGVuZ3RoID4gMSkgew0KICAgICAgICBpZiAoIXRoaXMucnVsZXNGb3JtLnJvbGUpIHsNCiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLor7fpgInmi6nop5LoibIiKTsNCiAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgbGV0IG1lbnVzID0gdGhpcy5tZW51czsNCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtZW51cy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgIGlmIChtZW51c1tpXS5yb2xlTmFtZSA9PSB0aGlzLnJ1bGVzRm9ybS5yb2xlKSB7DQogICAgICAgICAgICB0aGlzLnRhYmxlTmFtZSA9IG1lbnVzW2ldLnRhYmxlTmFtZTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMudGFibGVOYW1lID0gdGhpcy5yb2xlc1swXS50YWJsZU5hbWU7DQogICAgICAgIHRoaXMucnVsZXNGb3JtLnJvbGUgPSB0aGlzLnJvbGVzWzBdLnJvbGVOYW1lOw0KICAgICAgfQ0KICAgICAgdGhpcy5sb2dpblBvc3QoKTsNCiAgICB9LA0KICAgIGxvZ2luUG9zdCgpIHsNCiAgICAgIHRoaXMuJGh0dHAoew0KICAgICAgICB1cmw6IGAke3RoaXMudGFibGVOYW1lfS9sb2dpbj91c2VybmFtZT0ke3RoaXMucnVsZXNGb3JtLnVzZXJuYW1lfSZwYXNzd29yZD0ke3RoaXMucnVsZXNGb3JtLnBhc3N3b3JkfWAsDQogICAgICAgIG1ldGhvZDogInBvc3QiLA0KICAgICAgfSkudGhlbigoeyBkYXRhIH0pID0+IHsNCiAgICAgICAgaWYgKGRhdGEgJiYgZGF0YS5jb2RlID09PSAwKSB7DQogICAgICAgICAgLy8g55m75b2V5oiQ5Yqf5ZCO6YeN572u5aSx6LSl5qyh5pWw5ZKM6aqM6K+B56CB5L+h5oGvDQogICAgICAgICAgdGhpcy5sb2dpbkVycm9yQ291bnQgPSAwOw0KICAgICAgICAgIHRoaXMuY2FwdGNoYSA9ICIiOw0KICAgICAgICAgIHRoaXMuY2FwdGNoYUlucHV0ID0gIiI7DQogICAgICAgICAgdGhpcy4kc3RvcmFnZS5zZXQoIlRva2VuIiwgZGF0YS50b2tlbik7DQogICAgICAgICAgdGhpcy4kc3RvcmFnZS5zZXQoInJvbGUiLCB0aGlzLnJ1bGVzRm9ybS5yb2xlKTsNCiAgICAgICAgICB0aGlzLiRzdG9yYWdlLnNldCgic2Vzc2lvblRhYmxlIiwgdGhpcy50YWJsZU5hbWUpOw0KICAgICAgICAgIHRoaXMuJHN0b3JhZ2Uuc2V0KCJhZG1pbk5hbWUiLCB0aGlzLnJ1bGVzRm9ybS51c2VybmFtZSk7DQogICAgICAgICAgdGhpcy4kcm91dGVyLnJlcGxhY2UoeyBwYXRoOiAiLyIgfSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihkYXRhLm1zZyk7DQogICAgICAgICAgLy8g57Sv6K6h55m75b2V5aSx6LSl5qyh5pWwDQogICAgICAgICAgdGhpcy5sb2dpbkVycm9yQ291bnQrKzsNCiAgICAgICAgICAvLyDlvZPov57nu63lpLHotKXovr7liLAz5qyh5pe255Sf5oiQ6aqM6K+B56CBDQogICAgICAgICAgaWYgKHRoaXMubG9naW5FcnJvckNvdW50ID09PSAzKSB7DQogICAgICAgICAgICB0aGlzLmdlbmVyYXRlQ2FwdGNoYSgpOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfSwNCiAgfSwNCn07DQo="},{"version":3,"sources":["login.vue"],"names":[],"mappings":";AAqGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"login.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"page-wrapper\">\r\n    <!-- 单一容器：宽1200px，高600px -->\r\n    <div class=\"login-container\">\r\n      <!-- 左侧：表单区域 -->\r\n      <div class=\"form-section\">\r\n        <el-form class=\"login-el-form\">\r\n          <!-- 将表单字段单独放入一个 div 中 -->\r\n          <div class=\"form-fields\">\r\n            <!-- 标题 -->\r\n            <div class=\"form-title\" v-if=\"true\">\r\n              欢迎您，管理员用户\r\n            </div>\r\n\r\n            <!-- 用户名 -->\r\n            <div class=\"list-item\" v-if=\"loginType == 1\">\r\n              <div class=\"label\">用户名：</div>\r\n              <input\r\n                  class=\"login-input\"\r\n                  placeholder=\"请输入用户名\"\r\n                  name=\"username\"\r\n                  type=\"text\"\r\n                  v-model=\"rulesForm.username\"\r\n              />\r\n            </div>\r\n\r\n            <!-- 密码 -->\r\n            <div class=\"list-item\" v-if=\"loginType == 1\">\r\n              <div class=\"label\">密&nbsp;&nbsp;&nbsp;码：</div>\r\n              <input\r\n                  class=\"login-input\"\r\n                  placeholder=\"请输入密码\"\r\n                  name=\"password\"\r\n                  type=\"password\"\r\n                  v-model=\"rulesForm.password\"\r\n              />\r\n            </div>\r\n\r\n            <!-- 验证码：当连续输错3次后显示 -->\r\n            <div class=\"list-item\" v-if=\"loginErrorCount >= 3\">\r\n              <div class=\"label\">验证码：</div>\r\n              <input\r\n                  class=\"login-authcode\"\r\n                  placeholder=\"请输入验证码\"\r\n                  name=\"captcha\"\r\n                  type=\"text\"\r\n                  v-model=\"captchaInput\"\r\n              />\r\n              <!-- 使用canvas展示验证码，点击刷新 -->\r\n              <canvas\r\n                  ref=\"captchaCanvas\"\r\n                  width=\"120\"\r\n                  height=\"40\"\r\n                  class=\"captcha-canvas\"\r\n                  @click=\"generateCaptcha\"\r\n              ></canvas>\r\n            </div>\r\n\r\n            <!-- 角色单选 -->\r\n            <div class=\"login-radio\" v-if=\"roles.length > 1\" prop=\"loginInRole\">\r\n              <el-radio\r\n                  v-if=\"loginType == 1 || (loginType == 2 && item.roleName != '管理员')\"\r\n                  v-for=\"item in roles\"\r\n                  :key=\"item.roleName\"\r\n                  v-model=\"rulesForm.role\"\r\n                  :label=\"item.roleName\"\r\n              >\r\n                {{ item.roleName }}\r\n              </el-radio>\r\n            </div>\r\n\r\n            <!-- 登录按钮 -->\r\n            <div class=\"login-btn-wrap\">\r\n              <el-button\r\n                  class=\"login-btn\"\r\n                  v-if=\"loginType == 1\"\r\n                  type=\"primary\"\r\n                  @click=\"login\"\r\n              >\r\n                登录\r\n              </el-button>\r\n            </div>\r\n          </div>\r\n        </el-form>\r\n      </div>\r\n\r\n      <!-- 右侧：图片区域 -->\r\n      <div class=\"image-section\">\r\n        <img\r\n            src=\"https://img.freepik.com/free-vector/mobile-login-concept-illustration_114360-83.jpg\"\r\n            alt=\"登录插画\"\r\n        />\r\n      </div>\r\n    </div>\r\n    <footer class=\"bottom-footer\">\r\n      @ all right reserved by  甘肃政法大学 张恒毓 2025\r\n    </footer>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport menu from \"@/utils/menu\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      verifyCheck2: false,\r\n      flag: false,\r\n      baseUrl: this.$base.url,\r\n      loginType: 1,\r\n      rulesForm: {\r\n        username: \"\",\r\n        password: \"\",\r\n        role: \"\",\r\n      },\r\n      menus: [],\r\n      roles: [],\r\n      tableName: \"\",\r\n      // 新增字段\r\n      loginErrorCount: 0, // 记录连续登录失败次数\r\n      captcha: \"\",        // 验证码字符串\r\n      captchaInput: \"\",   // 用户输入的验证码\r\n    };\r\n  },\r\n  mounted() {\r\n    let menus = menu.list();\r\n    this.menus = menus;\r\n    for (let i = 0; i < this.menus.length; i++) {\r\n      if (this.menus[i].hasBackLogin == '是') {\r\n        this.roles.push(this.menus[i]);\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    // 生成验证码及绘制干扰项\r\n    generateCaptcha() {\r\n      // 生成一个随机4位验证码字符串\r\n      const chars = 'ABCDEFGHJKMNPQRSTUVWXYZabcdefghjkmnpqrstuvwxyz23456789';\r\n      let result = '';\r\n      for (let i = 0; i < 4; i++) {\r\n        result += chars.charAt(Math.floor(Math.random() * chars.length));\r\n      }\r\n      this.captcha = result;\r\n      // 调用绘制方法\r\n      this.drawCaptcha();\r\n      // 每次刷新时清空用户输入\r\n      this.captchaInput = \"\";\r\n    },\r\n    // 绘制验证码到canvas上\r\n    drawCaptcha() {\r\n      const canvas = this.$refs.captchaCanvas;\r\n      if (!canvas) return;\r\n      const ctx = canvas.getContext(\"2d\");\r\n      const width = canvas.width;\r\n      const height = canvas.height;\r\n      // 清空画布\r\n      ctx.clearRect(0, 0, width, height);\r\n      // 绘制背景颜色\r\n      ctx.fillStyle = \"#f0f0f0\";\r\n      ctx.fillRect(0, 0, width, height);\r\n      // 绘制验证码文字\r\n      for (let i = 0; i < this.captcha.length; i++) {\r\n        const char = this.captcha[i];\r\n        // 随机字体大小和颜色\r\n        const fontSize = 20 + Math.floor(Math.random() * 10);\r\n        const angle = Math.random() * 30 * Math.PI / 180;\r\n        ctx.font = `${fontSize}px Arial`;\r\n        ctx.fillStyle = `rgb(${Math.floor(Math.random()*100)}, ${Math.floor(Math.random()*100)}, ${Math.floor(Math.random()*100)})`;\r\n        // 设置文字位置及旋转\r\n        ctx.save();\r\n        const x = 10 + i * 25;\r\n        const y = 25 + Math.floor(Math.random() * 10);\r\n        ctx.translate(x, y);\r\n        ctx.rotate(angle);\r\n        ctx.fillText(char, 0, 0);\r\n        ctx.restore();\r\n      }\r\n      // 绘制干扰线\r\n      for (let i = 0; i < 5; i++) {\r\n        ctx.strokeStyle = `rgb(${Math.floor(Math.random()*255)}, ${Math.floor(Math.random()*255)}, ${Math.floor(Math.random()*255)})`;\r\n        ctx.beginPath();\r\n        ctx.moveTo(Math.random() * width, Math.random() * height);\r\n        ctx.lineTo(Math.random() * width, Math.random() * height);\r\n        ctx.stroke();\r\n      }\r\n      // 绘制干扰点\r\n      for (let i = 0; i < 30; i++) {\r\n        ctx.fillStyle = `rgb(${Math.floor(Math.random()*255)}, ${Math.floor(Math.random()*255)}, ${Math.floor(Math.random()*255)})`;\r\n        const x = Math.random() * width;\r\n        const y = Math.random() * height;\r\n        ctx.beginPath();\r\n        ctx.arc(x, y, 1, 0, 2 * Math.PI);\r\n        ctx.fill();\r\n      }\r\n    },\r\n    // 注册\r\n    register(tableName) {\r\n      this.$storage.set(\"loginTable\", tableName);\r\n      this.$router.push({ path: \"/register\", query: { pageFlag: \"register\" } });\r\n    },\r\n    // 登陆\r\n    login() {\r\n      // 当连续失败3次后，需要验证验证码\r\n      if (this.loginErrorCount >= 3) {\r\n        if (!this.captchaInput) {\r\n          this.$message.error(\"请输入验证码\");\r\n          return;\r\n        }\r\n        if (this.captchaInput.toLowerCase() !== this.captcha.toLowerCase()) {\r\n          this.$message.error(\"验证码错误，请重新输入\");\r\n          this.generateCaptcha();\r\n          return;\r\n        }\r\n      }\r\n      if (!this.rulesForm.username) {\r\n        this.$message.error(\"请输入用户名\");\r\n        return;\r\n      }\r\n      if (!this.rulesForm.password) {\r\n        this.$message.error(\"请输入密码\");\r\n        return;\r\n      }\r\n      if (this.roles.length > 1) {\r\n        if (!this.rulesForm.role) {\r\n          this.$message.error(\"请选择角色\");\r\n          return;\r\n        }\r\n        let menus = this.menus;\r\n        for (let i = 0; i < menus.length; i++) {\r\n          if (menus[i].roleName == this.rulesForm.role) {\r\n            this.tableName = menus[i].tableName;\r\n          }\r\n        }\r\n      } else {\r\n        this.tableName = this.roles[0].tableName;\r\n        this.rulesForm.role = this.roles[0].roleName;\r\n      }\r\n      this.loginPost();\r\n    },\r\n    loginPost() {\r\n      this.$http({\r\n        url: `${this.tableName}/login?username=${this.rulesForm.username}&password=${this.rulesForm.password}`,\r\n        method: \"post\",\r\n      }).then(({ data }) => {\r\n        if (data && data.code === 0) {\r\n          // 登录成功后重置失败次数和验证码信息\r\n          this.loginErrorCount = 0;\r\n          this.captcha = \"\";\r\n          this.captchaInput = \"\";\r\n          this.$storage.set(\"Token\", data.token);\r\n          this.$storage.set(\"role\", this.rulesForm.role);\r\n          this.$storage.set(\"sessionTable\", this.tableName);\r\n          this.$storage.set(\"adminName\", this.rulesForm.username);\r\n          this.$router.replace({ path: \"/\" });\r\n        } else {\r\n          this.$message.error(data.msg);\r\n          // 累计登录失败次数\r\n          this.loginErrorCount++;\r\n          // 当连续失败达到3次时生成验证码\r\n          if (this.loginErrorCount === 3) {\r\n            this.generateCaptcha();\r\n          }\r\n        }\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.page-wrapper {\r\n  width: 100%;\r\n  height: 100vh;\r\n  background-color: #f5f6fa;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  margin: 0;\r\n}\r\n\r\n.login-container {\r\n  width: 1200px;\r\n  height: 600px;\r\n  display: flex;\r\n  flex-direction: row;\r\n  margin: 0;\r\n  padding: 0;\r\n  border: 1px solid #ddd;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.form-section {\r\n  width: 60%;\r\n  height: 100%;\r\n  display: flex;\r\n  background: #fff;\r\n}\r\n\r\n.login-el-form {\r\n  width: 100%;\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n  background: #fff;\r\n  box-shadow: 0 1px 20px rgba(255, 255, 255, 0.8);\r\n  border-radius: 4px;\r\n}\r\n\r\n.form-fields {\r\n  width: 80%;\r\n  margin: 0 auto;\r\n}\r\n\r\n.form-title {\r\n  width: 100%;\r\n  margin: 100px 20px 100px 20px;\r\n  line-height: 44px;\r\n  font-size: 35px;\r\n  color: #374254;\r\n  text-align: center;\r\n}\r\n\r\n.list-item {\r\n  margin: 0 auto 10px;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.label {\r\n  width: 64px;\r\n  line-height: 44px;\r\n  font-size: 14px;\r\n  color: #374254;\r\n  font-weight: 600;\r\n  margin-left: 50px;\r\n  margin-top: 10px;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.login-input, .login-authcode {\r\n  border: 1px solid rgba(167, 180, 201, 0.3);\r\n  padding: 0 10px;\r\n  color: #374254;\r\n  outline-offset: 4px;\r\n  font-size: 14px;\r\n  height: 44px;\r\n  border-radius: 30px;\r\n}\r\n\r\n.login-input {\r\n  width: 400px;\r\n}\r\n\r\n.login-authcode {\r\n  width: 265px;\r\n}\r\n\r\n.captcha-canvas {\r\n  margin-left: 10px;\r\n  vertical-align: middle;\r\n  border: 1px solid #ddd;\r\n  cursor: pointer;\r\n}\r\n\r\n.login-radio {\r\n  margin: 20px auto;\r\n  text-align: center;\r\n}\r\n\r\n.login-btn-wrap {\r\n  width: 100%;\r\n  margin: 20px auto;\r\n  display: flex;\r\n  justify-content: center;\r\n}\r\n\r\n.login-btn {\r\n  border: 0;\r\n  cursor: pointer;\r\n  padding: 0 24px;\r\n  margin: 10px;\r\n  outline: none;\r\n  color: #fff;\r\n  border-radius: 30px;\r\n  background: #409eff;\r\n  width: 100px;\r\n  font-size: 16px;\r\n  height: 44px;\r\n  margin-left: 80px;\r\n  margin-top: 30px;\r\n}\r\n\r\n.image-section {\r\n  width: 50%;\r\n  height: 100%;\r\n  overflow: hidden;\r\n  img {\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: cover;\r\n    display: block;\r\n  }\r\n}\r\n\r\n.bottom-footer {\r\n  position: absolute;\r\n  bottom: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 80px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  text-align: center;\r\n  background-color: white;\r\n  font-size: 16px;\r\n  color: #909399;\r\n  border-top: 1px solid #ddd;\r\n}\r\n</style>\r\n"]}]}