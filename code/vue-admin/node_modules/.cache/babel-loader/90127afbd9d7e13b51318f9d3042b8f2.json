{"remainingRequest":"D:\\0javaproject\\code\\vue-admin\\node_modules\\babel-loader\\lib\\index.js!D:\\0javaproject\\code\\vue-admin\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\0javaproject\\code\\vue-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\0javaproject\\code\\vue-admin\\src\\views\\login.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\0javaproject\\code\\vue-admin\\src\\views\\login.vue","mtime":1742912559294},{"path":"D:\\0javaproject\\code\\vue-admin\\babel.config.js","mtime":1739010663574},{"path":"D:\\0javaproject\\code\\vue-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\0javaproject\\code\\vue-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"D:\\0javaproject\\code\\vue-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\0javaproject\\code\\vue-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsbC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnB1c2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlLmpzIjsKaW1wb3J0IG1lbnUgZnJvbSAiQC91dGlscy9tZW51IjsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB2ZXJpZnlDaGVjazI6IGZhbHNlLAogICAgICBmbGFnOiBmYWxzZSwKICAgICAgYmFzZVVybDogdGhpcy4kYmFzZS51cmwsCiAgICAgIGxvZ2luVHlwZTogMSwKICAgICAgcnVsZXNGb3JtOiB7CiAgICAgICAgdXNlcm5hbWU6ICIiLAogICAgICAgIHBhc3N3b3JkOiAiIiwKICAgICAgICByb2xlOiAiIgogICAgICB9LAogICAgICBtZW51czogW10sCiAgICAgIHJvbGVzOiBbXSwKICAgICAgdGFibGVOYW1lOiAiIiwKICAgICAgLy8g5paw5aKe5a2X5q61CiAgICAgIGxvZ2luRXJyb3JDb3VudDogMCwKICAgICAgLy8g6K6w5b2V6L+e57ut55m75b2V5aSx6LSl5qyh5pWwCiAgICAgIGNhcHRjaGE6ICIiLAogICAgICAvLyDpqozor4HnoIHlrZfnrKbkuLIKICAgICAgY2FwdGNoYUlucHV0OiAiIiAvLyDnlKjmiLfovpPlhaXnmoTpqozor4HnoIEKICAgIH07CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgdmFyIG1lbnVzID0gbWVudS5saXN0KCk7CiAgICB0aGlzLm1lbnVzID0gbWVudXM7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubWVudXMubGVuZ3RoOyBpKyspIHsKICAgICAgaWYgKHRoaXMubWVudXNbaV0uaGFzQmFja0xvZ2luID09ICfmmK8nKSB7CiAgICAgICAgdGhpcy5yb2xlcy5wdXNoKHRoaXMubWVudXNbaV0pOwogICAgICB9CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICAvLyDnlJ/miJDpqozor4HnoIHlj4rnu5jliLblubLmibDpobkKICAgIGdlbmVyYXRlQ2FwdGNoYTogZnVuY3Rpb24gZ2VuZXJhdGVDYXB0Y2hhKCkgewogICAgICAvLyDnlJ/miJDkuIDkuKrpmo/mnLo05L2N6aqM6K+B56CB5a2X56ym5LiyCiAgICAgIHZhciBjaGFycyA9ICdBQkNERUZHSEpLTU5QUVJTVFVWV1hZWmFiY2RlZmdoamttbnBxcnN0dXZ3eHl6MjM0NTY3ODknOwogICAgICB2YXIgcmVzdWx0ID0gJyc7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNDsgaSsrKSB7CiAgICAgICAgcmVzdWx0ICs9IGNoYXJzLmNoYXJBdChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjaGFycy5sZW5ndGgpKTsKICAgICAgfQogICAgICB0aGlzLmNhcHRjaGEgPSByZXN1bHQ7CiAgICAgIC8vIOiwg+eUqOe7mOWItuaWueazlQogICAgICB0aGlzLmRyYXdDYXB0Y2hhKCk7CiAgICAgIC8vIOavj+asoeWIt+aWsOaXtua4heepuueUqOaIt+i+k+WFpQogICAgICB0aGlzLmNhcHRjaGFJbnB1dCA9ICIiOwogICAgfSwKICAgIC8vIOe7mOWItumqjOivgeeggeWIsGNhbnZhc+S4igogICAgZHJhd0NhcHRjaGE6IGZ1bmN0aW9uIGRyYXdDYXB0Y2hhKCkgewogICAgICB2YXIgY2FudmFzID0gdGhpcy4kcmVmcy5jYXB0Y2hhQ2FudmFzOwogICAgICBpZiAoIWNhbnZhcykgcmV0dXJuOwogICAgICB2YXIgY3R4ID0gY2FudmFzLmdldENvbnRleHQoIjJkIik7CiAgICAgIHZhciB3aWR0aCA9IGNhbnZhcy53aWR0aDsKICAgICAgdmFyIGhlaWdodCA9IGNhbnZhcy5oZWlnaHQ7CiAgICAgIC8vIOa4heepuueUu+W4gwogICAgICBjdHguY2xlYXJSZWN0KDAsIDAsIHdpZHRoLCBoZWlnaHQpOwogICAgICAvLyDnu5jliLbog4zmma/popzoibIKICAgICAgY3R4LmZpbGxTdHlsZSA9ICIjZjBmMGYwIjsKICAgICAgY3R4LmZpbGxSZWN0KDAsIDAsIHdpZHRoLCBoZWlnaHQpOwogICAgICAvLyDnu5jliLbpqozor4HnoIHmloflrZcKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmNhcHRjaGEubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgX2NoYXIgPSB0aGlzLmNhcHRjaGFbaV07CiAgICAgICAgLy8g6ZqP5py65a2X5L2T5aSn5bCP5ZKM6aKc6ImyCiAgICAgICAgdmFyIGZvbnRTaXplID0gMjAgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7CiAgICAgICAgdmFyIGFuZ2xlID0gTWF0aC5yYW5kb20oKSAqIDMwICogTWF0aC5QSSAvIDE4MDsKICAgICAgICBjdHguZm9udCA9ICIiLmNvbmNhdChmb250U2l6ZSwgInB4IEFyaWFsIik7CiAgICAgICAgY3R4LmZpbGxTdHlsZSA9ICJyZ2IoIi5jb25jYXQoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKSwgIiwgIikuY29uY2F0KE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCksICIsICIpLmNvbmNhdChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApLCAiKSIpOwogICAgICAgIC8vIOiuvue9ruaWh+Wtl+S9jee9ruWPiuaXi+i9rAogICAgICAgIGN0eC5zYXZlKCk7CiAgICAgICAgdmFyIHggPSAxMCArIGkgKiAyNTsKICAgICAgICB2YXIgeSA9IDI1ICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApOwogICAgICAgIGN0eC50cmFuc2xhdGUoeCwgeSk7CiAgICAgICAgY3R4LnJvdGF0ZShhbmdsZSk7CiAgICAgICAgY3R4LmZpbGxUZXh0KF9jaGFyLCAwLCAwKTsKICAgICAgICBjdHgucmVzdG9yZSgpOwogICAgICB9CiAgICAgIC8vIOe7mOWItuW5suaJsOe6vwogICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgNTsgX2krKykgewogICAgICAgIGN0eC5zdHJva2VTdHlsZSA9ICJyZ2IoIi5jb25jYXQoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMjU1KSwgIiwgIikuY29uY2F0KE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDI1NSksICIsICIpLmNvbmNhdChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAyNTUpLCAiKSIpOwogICAgICAgIGN0eC5iZWdpblBhdGgoKTsKICAgICAgICBjdHgubW92ZVRvKE1hdGgucmFuZG9tKCkgKiB3aWR0aCwgTWF0aC5yYW5kb20oKSAqIGhlaWdodCk7CiAgICAgICAgY3R4LmxpbmVUbyhNYXRoLnJhbmRvbSgpICogd2lkdGgsIE1hdGgucmFuZG9tKCkgKiBoZWlnaHQpOwogICAgICAgIGN0eC5zdHJva2UoKTsKICAgICAgfQogICAgICAvLyDnu5jliLblubLmibDngrkKICAgICAgZm9yICh2YXIgX2kyID0gMDsgX2kyIDwgMzA7IF9pMisrKSB7CiAgICAgICAgY3R4LmZpbGxTdHlsZSA9ICJyZ2IoIi5jb25jYXQoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMjU1KSwgIiwgIikuY29uY2F0KE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDI1NSksICIsICIpLmNvbmNhdChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAyNTUpLCAiKSIpOwogICAgICAgIHZhciBfeCA9IE1hdGgucmFuZG9tKCkgKiB3aWR0aDsKICAgICAgICB2YXIgX3kgPSBNYXRoLnJhbmRvbSgpICogaGVpZ2h0OwogICAgICAgIGN0eC5iZWdpblBhdGgoKTsKICAgICAgICBjdHguYXJjKF94LCBfeSwgMSwgMCwgMiAqIE1hdGguUEkpOwogICAgICAgIGN0eC5maWxsKCk7CiAgICAgIH0KICAgIH0sCiAgICAvLyDms6jlhowKICAgIHJlZ2lzdGVyOiBmdW5jdGlvbiByZWdpc3Rlcih0YWJsZU5hbWUpIHsKICAgICAgdGhpcy4kc3RvcmFnZS5zZXQoImxvZ2luVGFibGUiLCB0YWJsZU5hbWUpOwogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgcGF0aDogIi9yZWdpc3RlciIsCiAgICAgICAgcXVlcnk6IHsKICAgICAgICAgIHBhZ2VGbGFnOiAicmVnaXN0ZXIiCiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICAvLyDnmbvpmYYKICAgIGxvZ2luOiBmdW5jdGlvbiBsb2dpbigpIHsKICAgICAgLy8g5b2T6L+e57ut5aSx6LSlM+asoeWQju+8jOmcgOimgemqjOivgemqjOivgeeggQogICAgICBpZiAodGhpcy5sb2dpbkVycm9yQ291bnQgPj0gMykgewogICAgICAgIGlmICghdGhpcy5jYXB0Y2hhSW5wdXQpIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIuivt+i+k+WFpemqjOivgeeggSIpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAodGhpcy5jYXB0Y2hhSW5wdXQudG9Mb3dlckNhc2UoKSAhPT0gdGhpcy5jYXB0Y2hhLnRvTG93ZXJDYXNlKCkpIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIumqjOivgeeggemUmeivr++8jOivt+mHjeaWsOi+k+WFpSIpOwogICAgICAgICAgdGhpcy5nZW5lcmF0ZUNhcHRjaGEoKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKCF0aGlzLnJ1bGVzRm9ybS51c2VybmFtZSkgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIuivt+i+k+WFpeeUqOaIt+WQjSIpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAoIXRoaXMucnVsZXNGb3JtLnBhc3N3b3JkKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcigi6K+36L6T5YWl5a+G56CBIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmICh0aGlzLnJvbGVzLmxlbmd0aCA+IDEpIHsKICAgICAgICBpZiAoIXRoaXMucnVsZXNGb3JtLnJvbGUpIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIuivt+mAieaLqeinkuiJsiIpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICB2YXIgbWVudXMgPSB0aGlzLm1lbnVzOwogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWVudXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGlmIChtZW51c1tpXS5yb2xlTmFtZSA9PSB0aGlzLnJ1bGVzRm9ybS5yb2xlKSB7CiAgICAgICAgICAgIHRoaXMudGFibGVOYW1lID0gbWVudXNbaV0udGFibGVOYW1lOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnRhYmxlTmFtZSA9IHRoaXMucm9sZXNbMF0udGFibGVOYW1lOwogICAgICAgIHRoaXMucnVsZXNGb3JtLnJvbGUgPSB0aGlzLnJvbGVzWzBdLnJvbGVOYW1lOwogICAgICB9CiAgICAgIHRoaXMubG9naW5Qb3N0KCk7CiAgICB9LAogICAgbG9naW5Qb3N0OiBmdW5jdGlvbiBsb2dpblBvc3QoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHRoaXMuJGh0dHAoewogICAgICAgIHVybDogIiIuY29uY2F0KHRoaXMudGFibGVOYW1lLCAiL2xvZ2luP3VzZXJuYW1lPSIpLmNvbmNhdCh0aGlzLnJ1bGVzRm9ybS51c2VybmFtZSwgIiZwYXNzd29yZD0iKS5jb25jYXQodGhpcy5ydWxlc0Zvcm0ucGFzc3dvcmQpLAogICAgICAgIG1ldGhvZDogInBvc3QiCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKF9yZWYpIHsKICAgICAgICB2YXIgZGF0YSA9IF9yZWYuZGF0YTsKICAgICAgICBpZiAoZGF0YSAmJiBkYXRhLmNvZGUgPT09IDApIHsKICAgICAgICAgIC8vIOeZu+W9leaIkOWKn+WQjumHjee9ruWksei0peasoeaVsOWSjOmqjOivgeeggeS/oeaBrwogICAgICAgICAgX3RoaXMubG9naW5FcnJvckNvdW50ID0gMDsKICAgICAgICAgIF90aGlzLmNhcHRjaGEgPSAiIjsKICAgICAgICAgIF90aGlzLmNhcHRjaGFJbnB1dCA9ICIiOwogICAgICAgICAgX3RoaXMuJHN0b3JhZ2Uuc2V0KCJUb2tlbiIsIGRhdGEudG9rZW4pOwogICAgICAgICAgX3RoaXMuJHN0b3JhZ2Uuc2V0KCJyb2xlIiwgX3RoaXMucnVsZXNGb3JtLnJvbGUpOwogICAgICAgICAgX3RoaXMuJHN0b3JhZ2Uuc2V0KCJzZXNzaW9uVGFibGUiLCBfdGhpcy50YWJsZU5hbWUpOwogICAgICAgICAgX3RoaXMuJHN0b3JhZ2Uuc2V0KCJhZG1pbk5hbWUiLCBfdGhpcy5ydWxlc0Zvcm0udXNlcm5hbWUpOwogICAgICAgICAgX3RoaXMuJHJvdXRlci5yZXBsYWNlKHsKICAgICAgICAgICAgcGF0aDogIi8iCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgX3RoaXMuJG1lc3NhZ2UuZXJyb3IoZGF0YS5tc2cpOwogICAgICAgICAgLy8g57Sv6K6h55m75b2V5aSx6LSl5qyh5pWwCiAgICAgICAgICBfdGhpcy5sb2dpbkVycm9yQ291bnQrKzsKICAgICAgICAgIC8vIOW9k+i/nue7reWksei0pei+vuWIsDPmrKHml7bnlJ/miJDpqozor4HnoIEKICAgICAgICAgIGlmIChfdGhpcy5sb2dpbkVycm9yQ291bnQgPT09IDMpIHsKICAgICAgICAgICAgX3RoaXMuZ2VuZXJhdGVDYXB0Y2hhKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9Cn07"},{"version":3,"names":["menu","data","verifyCheck2","flag","baseUrl","$base","url","loginType","rulesForm","username","password","role","menus","roles","tableName","loginErrorCount","captcha","captchaInput","mounted","list","i","length","hasBackLogin","push","methods","generateCaptcha","chars","result","charAt","Math","floor","random","drawCaptcha","canvas","$refs","captchaCanvas","ctx","getContext","width","height","clearRect","fillStyle","fillRect","char","fontSize","angle","PI","font","concat","save","x","y","translate","rotate","fillText","restore","strokeStyle","beginPath","moveTo","lineTo","stroke","arc","fill","register","$storage","set","$router","path","query","pageFlag","login","$message","error","toLowerCase","roleName","loginPost","_this","$http","method","then","_ref","code","token","replace","msg"],"sources":["src/views/login.vue"],"sourcesContent":["<template>\r\n  <div class=\"page-wrapper\">\r\n    <!-- 单一容器：宽1200px，高600px -->\r\n    <div class=\"login-container\">\r\n      <!-- 左侧：表单区域 -->\r\n      <div class=\"form-section\">\r\n        <el-form class=\"login-el-form\">\r\n          <!-- 将表单字段单独放入一个 div 中 -->\r\n          <div class=\"form-fields\">\r\n            <!-- 标题 -->\r\n            <div class=\"form-title\" v-if=\"true\">\r\n              欢迎您，管理员用户\r\n            </div>\r\n\r\n            <!-- 用户名 -->\r\n            <div class=\"list-item\" v-if=\"loginType == 1\">\r\n              <div class=\"label\">用户名：</div>\r\n              <input\r\n                  class=\"login-input\"\r\n                  placeholder=\"请输入用户名\"\r\n                  name=\"username\"\r\n                  type=\"text\"\r\n                  v-model=\"rulesForm.username\"\r\n              />\r\n            </div>\r\n\r\n            <!-- 密码 -->\r\n            <div class=\"list-item\" v-if=\"loginType == 1\">\r\n              <div class=\"label\">密&nbsp;&nbsp;&nbsp;码：</div>\r\n              <input\r\n                  class=\"login-input\"\r\n                  placeholder=\"请输入密码\"\r\n                  name=\"password\"\r\n                  type=\"password\"\r\n                  v-model=\"rulesForm.password\"\r\n              />\r\n            </div>\r\n\r\n            <!-- 验证码：当连续输错3次后显示 -->\r\n            <div class=\"list-item\" v-if=\"loginErrorCount >= 3\">\r\n              <div class=\"label\">验证码：</div>\r\n              <input\r\n                  class=\"login-authcode\"\r\n                  placeholder=\"请输入验证码\"\r\n                  name=\"captcha\"\r\n                  type=\"text\"\r\n                  v-model=\"captchaInput\"\r\n              />\r\n              <!-- 使用canvas展示验证码，点击刷新 -->\r\n              <canvas\r\n                  ref=\"captchaCanvas\"\r\n                  width=\"120\"\r\n                  height=\"40\"\r\n                  class=\"captcha-canvas\"\r\n                  @click=\"generateCaptcha\"\r\n              ></canvas>\r\n            </div>\r\n\r\n            <!-- 角色单选 -->\r\n            <div class=\"login-radio\" v-if=\"roles.length > 1\" prop=\"loginInRole\">\r\n              <el-radio\r\n                  v-if=\"loginType == 1 || (loginType == 2 && item.roleName != '管理员')\"\r\n                  v-for=\"item in roles\"\r\n                  :key=\"item.roleName\"\r\n                  v-model=\"rulesForm.role\"\r\n                  :label=\"item.roleName\"\r\n              >\r\n                {{ item.roleName }}\r\n              </el-radio>\r\n            </div>\r\n\r\n            <!-- 登录按钮 -->\r\n            <div class=\"login-btn-wrap\">\r\n              <el-button\r\n                  class=\"login-btn\"\r\n                  v-if=\"loginType == 1\"\r\n                  type=\"primary\"\r\n                  @click=\"login\"\r\n              >\r\n                登录\r\n              </el-button>\r\n            </div>\r\n          </div>\r\n        </el-form>\r\n      </div>\r\n\r\n      <!-- 右侧：图片区域 -->\r\n      <div class=\"image-section\">\r\n        <img\r\n            src=\"https://img.freepik.com/free-vector/mobile-login-concept-illustration_114360-83.jpg\"\r\n            alt=\"登录插画\"\r\n        />\r\n      </div>\r\n    </div>\r\n    <footer class=\"bottom-footer\">\r\n      @ all right reserved by  甘肃政法大学 张恒毓 2025\r\n    </footer>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport menu from \"@/utils/menu\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      verifyCheck2: false,\r\n      flag: false,\r\n      baseUrl: this.$base.url,\r\n      loginType: 1,\r\n      rulesForm: {\r\n        username: \"\",\r\n        password: \"\",\r\n        role: \"\",\r\n      },\r\n      menus: [],\r\n      roles: [],\r\n      tableName: \"\",\r\n      // 新增字段\r\n      loginErrorCount: 0, // 记录连续登录失败次数\r\n      captcha: \"\",        // 验证码字符串\r\n      captchaInput: \"\",   // 用户输入的验证码\r\n    };\r\n  },\r\n  mounted() {\r\n    let menus = menu.list();\r\n    this.menus = menus;\r\n    for (let i = 0; i < this.menus.length; i++) {\r\n      if (this.menus[i].hasBackLogin == '是') {\r\n        this.roles.push(this.menus[i]);\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    // 生成验证码及绘制干扰项\r\n    generateCaptcha() {\r\n      // 生成一个随机4位验证码字符串\r\n      const chars = 'ABCDEFGHJKMNPQRSTUVWXYZabcdefghjkmnpqrstuvwxyz23456789';\r\n      let result = '';\r\n      for (let i = 0; i < 4; i++) {\r\n        result += chars.charAt(Math.floor(Math.random() * chars.length));\r\n      }\r\n      this.captcha = result;\r\n      // 调用绘制方法\r\n      this.drawCaptcha();\r\n      // 每次刷新时清空用户输入\r\n      this.captchaInput = \"\";\r\n    },\r\n    // 绘制验证码到canvas上\r\n    drawCaptcha() {\r\n      const canvas = this.$refs.captchaCanvas;\r\n      if (!canvas) return;\r\n      const ctx = canvas.getContext(\"2d\");\r\n      const width = canvas.width;\r\n      const height = canvas.height;\r\n      // 清空画布\r\n      ctx.clearRect(0, 0, width, height);\r\n      // 绘制背景颜色\r\n      ctx.fillStyle = \"#f0f0f0\";\r\n      ctx.fillRect(0, 0, width, height);\r\n      // 绘制验证码文字\r\n      for (let i = 0; i < this.captcha.length; i++) {\r\n        const char = this.captcha[i];\r\n        // 随机字体大小和颜色\r\n        const fontSize = 20 + Math.floor(Math.random() * 10);\r\n        const angle = Math.random() * 30 * Math.PI / 180;\r\n        ctx.font = `${fontSize}px Arial`;\r\n        ctx.fillStyle = `rgb(${Math.floor(Math.random()*100)}, ${Math.floor(Math.random()*100)}, ${Math.floor(Math.random()*100)})`;\r\n        // 设置文字位置及旋转\r\n        ctx.save();\r\n        const x = 10 + i * 25;\r\n        const y = 25 + Math.floor(Math.random() * 10);\r\n        ctx.translate(x, y);\r\n        ctx.rotate(angle);\r\n        ctx.fillText(char, 0, 0);\r\n        ctx.restore();\r\n      }\r\n      // 绘制干扰线\r\n      for (let i = 0; i < 5; i++) {\r\n        ctx.strokeStyle = `rgb(${Math.floor(Math.random()*255)}, ${Math.floor(Math.random()*255)}, ${Math.floor(Math.random()*255)})`;\r\n        ctx.beginPath();\r\n        ctx.moveTo(Math.random() * width, Math.random() * height);\r\n        ctx.lineTo(Math.random() * width, Math.random() * height);\r\n        ctx.stroke();\r\n      }\r\n      // 绘制干扰点\r\n      for (let i = 0; i < 30; i++) {\r\n        ctx.fillStyle = `rgb(${Math.floor(Math.random()*255)}, ${Math.floor(Math.random()*255)}, ${Math.floor(Math.random()*255)})`;\r\n        const x = Math.random() * width;\r\n        const y = Math.random() * height;\r\n        ctx.beginPath();\r\n        ctx.arc(x, y, 1, 0, 2 * Math.PI);\r\n        ctx.fill();\r\n      }\r\n    },\r\n    // 注册\r\n    register(tableName) {\r\n      this.$storage.set(\"loginTable\", tableName);\r\n      this.$router.push({ path: \"/register\", query: { pageFlag: \"register\" } });\r\n    },\r\n    // 登陆\r\n    login() {\r\n      // 当连续失败3次后，需要验证验证码\r\n      if (this.loginErrorCount >= 3) {\r\n        if (!this.captchaInput) {\r\n          this.$message.error(\"请输入验证码\");\r\n          return;\r\n        }\r\n        if (this.captchaInput.toLowerCase() !== this.captcha.toLowerCase()) {\r\n          this.$message.error(\"验证码错误，请重新输入\");\r\n          this.generateCaptcha();\r\n          return;\r\n        }\r\n      }\r\n      if (!this.rulesForm.username) {\r\n        this.$message.error(\"请输入用户名\");\r\n        return;\r\n      }\r\n      if (!this.rulesForm.password) {\r\n        this.$message.error(\"请输入密码\");\r\n        return;\r\n      }\r\n      if (this.roles.length > 1) {\r\n        if (!this.rulesForm.role) {\r\n          this.$message.error(\"请选择角色\");\r\n          return;\r\n        }\r\n        let menus = this.menus;\r\n        for (let i = 0; i < menus.length; i++) {\r\n          if (menus[i].roleName == this.rulesForm.role) {\r\n            this.tableName = menus[i].tableName;\r\n          }\r\n        }\r\n      } else {\r\n        this.tableName = this.roles[0].tableName;\r\n        this.rulesForm.role = this.roles[0].roleName;\r\n      }\r\n      this.loginPost();\r\n    },\r\n    loginPost() {\r\n      this.$http({\r\n        url: `${this.tableName}/login?username=${this.rulesForm.username}&password=${this.rulesForm.password}`,\r\n        method: \"post\",\r\n      }).then(({ data }) => {\r\n        if (data && data.code === 0) {\r\n          // 登录成功后重置失败次数和验证码信息\r\n          this.loginErrorCount = 0;\r\n          this.captcha = \"\";\r\n          this.captchaInput = \"\";\r\n          this.$storage.set(\"Token\", data.token);\r\n          this.$storage.set(\"role\", this.rulesForm.role);\r\n          this.$storage.set(\"sessionTable\", this.tableName);\r\n          this.$storage.set(\"adminName\", this.rulesForm.username);\r\n          this.$router.replace({ path: \"/\" });\r\n        } else {\r\n          this.$message.error(data.msg);\r\n          // 累计登录失败次数\r\n          this.loginErrorCount++;\r\n          // 当连续失败达到3次时生成验证码\r\n          if (this.loginErrorCount === 3) {\r\n            this.generateCaptcha();\r\n          }\r\n        }\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.page-wrapper {\r\n  width: 100%;\r\n  height: 100vh;\r\n  background-color: #f5f6fa;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  margin: 0;\r\n}\r\n\r\n.login-container {\r\n  width: 1200px;\r\n  height: 600px;\r\n  display: flex;\r\n  flex-direction: row;\r\n  margin: 0;\r\n  padding: 0;\r\n  border: 1px solid #ddd;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.form-section {\r\n  width: 60%;\r\n  height: 100%;\r\n  display: flex;\r\n  background: #fff;\r\n}\r\n\r\n.login-el-form {\r\n  width: 100%;\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n  background: #fff;\r\n  box-shadow: 0 1px 20px rgba(255, 255, 255, 0.8);\r\n  border-radius: 4px;\r\n}\r\n\r\n.form-fields {\r\n  width: 80%;\r\n  margin: 0 auto;\r\n}\r\n\r\n.form-title {\r\n  width: 100%;\r\n  margin: 100px 20px 100px 20px;\r\n  line-height: 44px;\r\n  font-size: 35px;\r\n  color: #374254;\r\n  text-align: center;\r\n}\r\n\r\n.list-item {\r\n  margin: 0 auto 10px;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.label {\r\n  width: 64px;\r\n  line-height: 44px;\r\n  font-size: 14px;\r\n  color: #374254;\r\n  font-weight: 600;\r\n  margin-left: 50px;\r\n  margin-top: 10px;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.login-input, .login-authcode {\r\n  border: 1px solid rgba(167, 180, 201, 0.3);\r\n  padding: 0 10px;\r\n  color: #374254;\r\n  outline-offset: 4px;\r\n  font-size: 14px;\r\n  height: 44px;\r\n  border-radius: 30px;\r\n}\r\n\r\n.login-input {\r\n  width: 400px;\r\n}\r\n\r\n.login-authcode {\r\n  width: 265px;\r\n}\r\n\r\n.captcha-canvas {\r\n  margin-left: 10px;\r\n  vertical-align: middle;\r\n  border: 1px solid #ddd;\r\n  cursor: pointer;\r\n}\r\n\r\n.login-radio {\r\n  margin: 20px auto;\r\n  text-align: center;\r\n}\r\n\r\n.login-btn-wrap {\r\n  width: 100%;\r\n  margin: 20px auto;\r\n  display: flex;\r\n  justify-content: center;\r\n}\r\n\r\n.login-btn {\r\n  border: 0;\r\n  cursor: pointer;\r\n  padding: 0 24px;\r\n  margin: 10px;\r\n  outline: none;\r\n  color: #fff;\r\n  border-radius: 30px;\r\n  background: #409eff;\r\n  width: 100px;\r\n  font-size: 16px;\r\n  height: 44px;\r\n  margin-left: 80px;\r\n  margin-top: 30px;\r\n}\r\n\r\n.image-section {\r\n  width: 50%;\r\n  height: 100%;\r\n  overflow: hidden;\r\n  img {\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: cover;\r\n    display: block;\r\n  }\r\n}\r\n\r\n.bottom-footer {\r\n  position: absolute;\r\n  bottom: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 80px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  text-align: center;\r\n  background-color: white;\r\n  font-size: 16px;\r\n  color: #909399;\r\n  border-top: 1px solid #ddd;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]}]}